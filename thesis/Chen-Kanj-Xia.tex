\section{Algorytm Chen, Kanj, Xia}\label{s_ckx}
\subsection{Wstęp}
\par{
  Zaprezentowane w poprzednich rozdziałach pracy algorytmy związane są przede wszystkim z modyfikacją struktury grafu wejściowego w celu przyspieszenia procesu rozwiązywania problemu pokrycia wierzchołkowego.
  Każdy z przestawionych dotychczas algorytmów może być wykorzystywany niezależnie --- ich działanie jest ortogonalne względem siebie.
  Fakt ten nie uszedł uwadze autorów pracy~\cite{ImprovedBounds10}, którzy dostrzegli potencjał optymalizacji drzemiący w zastosowaniu starannie zaprojektowanego i przeanalizowanego modelu redukcji dziedziny do jądra problemu.
  Model ten oparty jest na stosunkowo prostym algorytmie rekurencyjnym działającym zgodnie z zasadą drzewa poszukiwań z ograniczeniami, popartym wyczerpującą analizą mogących zaistnieć po drodze przypadków.
  Wykorzystane w ramach działania algorytmu funkcje redukujące dziedzinę są od siebie mocno uzależnione oraz uruchamiane w ściśle określonej kolejności w celu zachowania poprawności logiki wysokopoziomowej i maksymalizacji pozytywnych efektów ich wykonywania.\footnote{Zawarty w niniejszej pracy opis algorytmu Chen, Kanj, Xia stanowi syntezę analizy algorytmu przeprowadzonej w różnych wersjach pracy~\cite{ImprovedBounds10}. Zaznaczyć należy, iż pominięte zostały w szczególności dowody związane z pesymistyczną złożonością czasową algorytmu, co podyktowane jest ich obszernością. Niemniej jednak stanowią one wartościowe uzupełnienie wiedzy przy implementacji algorytmu w oparciu o przedstawioną analizę.}
}
\par{
  Wedle autorów, główną motywacją do stworzenia niniejszego algorytmu było udowodnienie wagi gruntownej analizy dziedziny algorytmu (w przeciwieństwie do znacznie powszechniejszej analizy opartej o charakterystyczne przypadki) w celu uzyskania jak najdokładniejszych wartości pesymistycznej złożoności obliczeniowej.
  Zastosowane podejście czerpie inspirację z niezywkle efektywnej metodyki analitycznej ``mierz i zwyciężaj'', zaproponowanej w artykule~\cite{conf/icalp/FominGK05}.

  Drugim głównym celem pracy~\cite{ImprovedBounds10} jest studium najlepszej możliwej złożoności obliczeniowej osiągalnej dla problemu pokrycia wierzchołkowego.
  Wobec odkryć dokonanych w pracach~\cite{Impagliazzo2001512} oraz~\cite{Cai2003789} wyjawiających, iż dopóki nie zostanie udowodnione, że wszystkie problemy $\mathcal{SNP}$ są rozwiązywalne w czasie krótszym niż wykładniczy, istnieje pewna stała $c_0 > 1$, dla której problem pokrycia wierzchołkowego nie może być rozwiązany w czasie $c_0^kn^{O(1)}$.
  Uwaga poświęcona jest zatem próbom jak najbardziej znacznego zmniejszenia stałej $c > 1$, dla której problem pokrycia wierzchołkowego rozwiązywalny jest w czasie $c^kn^{O(1)}$.
}
\par {
  Otrzymany algorytm jest nieskomplikowany i jednolity, zachowuje również formę poddającą się w łatwy sposób dokładnej analizie.
  Kręgosłup algorytmu stanowi utrzymywana na bieżąco kolejka priorytetowa ``pożytecznych'' struktur służacych do redukowania dziedziny problemu.
  Na każdym z etapów algorytm wybiera strukturę o najwyższym priorytecie, zapewniającą najwięcej korzyści.
  Wybrana struktura przetwarzana jest w sposób \emph{jednolity} oraz \emph{nieświadomy} jej kształtu.
  W wyniku analiz udało się doprowadzić do stanu logiki, w której istnieją jedynie dwa możliwe sposoby (odzwierciedlone dwoma gałęziami algorytmu) przetwarzania dowolnej struktury.
  Pozostałe operacje nie posiadają żadnych rozgałęzień --- stanowią działania pomocnicze ``oczyszczające'' graf (podobnie jak algorytmy przetwarzania wstępnego omówione w podrozdziale~\ref{Section_preprocessing}) w celu zapewnienia największej możliwej wydajności następujących operacji z rozgałęzieniami.

  Złożoność czasowa algorytmu wynosi $O(1.2738^k + kn)$, co stawia go w światowej czołówce najszybszych algorytmów rozwiązujących parametryzowany wariant problemu pokrycia wierzchołkowego.
}
\subsection{Podstawowe pojęcia i obserwacje}\label{ss_ckx_preliminaries}
\par{
  W dalszym toku rozumowanie przyjęte zostaną następujące oznaczenia dla grafu $G=(V, E)$:
  \begin{itemize}
    \item $|G|$ stanowi liczbę wierzchołków $|V|$.
    \item $\tau(G)$ stanowi rozmiar najmniejszego pokrycia wierzchołkowego grafu $G$.
  \end{itemize}
  Dla pewnego wierzchołka $v \in V$:
  \begin{itemize}
    \item $N(v)$ stanowi zbiór wierzchołków sąsiednich względem wierzchołka $v$, to znaczy połączonych krawędzią z tym wierzchołkiem.
    \item $N[v]$ stanowi zbiór $N(v) \bigcup \{v\}$.
    \item $d(v)$ stanowi stopień wierzchołka $v$.
  \end{itemize}
  Dla pewnego zbioru wierzchołków $S \in V$:
  \begin{itemize}
    \item $N(S)$ stanowi sumę zbiorów wierzchołków sąsiednich dla każdego wierzchołka $v_S \in S$ z wyłączeniem $v_S$, to znaczy $N(S)=\bigcup_{v_S\in S}N(v_S) \setminus S$.
    \item $N[S]$ oznacza zbiór wierzchołków $N(S) \bigcup S$.
  \end{itemize}

  Przyjęte zostaje następujące założenie, oparte na drugim twierdzeniu Nemhausera-Trottera (twierdzenie~\ref{nt_lp}) oraz pojęciu NT-dekompozycji, opisanej w rozdziale~\ref{ss_nt_decomposition}.
  \begin{proposition}
    Istnieje algorytm o złożoności czasowej $O(kn + k^3)$ który z instancji problemu pokrycia wierzchołkowego $(G, k)$, gdzie $|G|=n$ konstruuje inną instancję problemu  pokrycia wierzchołkowego $(G_1, k_1)$, dla której $k_1 \leq k$ oraz $|G_1| \leq 2k_1$ oraz $\tau(G) \leq k$ wtedy i tylko wtedy gdy $\tau(G_1) \leq k_1$.
  \end{proposition}

  \begin{definition}
    Instancja $(G_1, k_1)$, otrzymana przez NT-dekompozycję instancji $(G, k)$, stanowi \emph{jądro} instancji $(G, k)$.
  \end{definition}
}
\par{
  Logika głównego algorytmu zrealizowana jest jako drzewo poszukiwań, zgodne z techniką opisywaną w podrozdziale~\ref{ss_branch_and_bound}.
  Każda iteracja podejmuje próby redukcji wartości parametru $k$ instancji wejściowej problemu pokrycia wierzchołkowego $(G, k)$ przez identyfikację pewnego zbioru wierzchołków $S$, który w całości przynależy do optymalnego pokrycia wierzchołkowego grafu $G$ lub też w całości jest z niego wykluczony.
  W przypadku odnalezienia takiego zbioru, algorytm usuwa należące do niego wierzchołki z dziedziny i rekurencyjnie wywołuje sam siebie na zredukowanych instancjach problemu.

  Sposób redukcji instancji problemu oparty jest o następujące prawidłowości zaobserwowane w zachowaniu pokrycia wierzchołkowego w grafie.
  \begin{theorem}\thlabel{th_include_neighborhood}
    Dla pewnego wierzchołka $v$ w grafie $G$ istnieje optymalne pokrycie wierzchołkowe grafu $G$ zawierające zbiór $N(v)$ lub co najwyżej $|N(v)| - 2$ wierzchołków należących do zbioru $N(v)$.
  \end{theorem}
  \begin{bproof}
    Jeżeli pewne optymalne pokrycie wierzchołkowe $C$ grafu $G$ zawiera $|N(v)|-1$ wierzchołków należących do zbioru $N(v)$, to musi ono zawierać również wierzchołek $v$, ponieważ krawędź $(w \in N(v) \setminus C, v)$ również musi zostać pokryta.
    Stworzyć można zatem inne optymalne pokrycie wierzchołkowe $C^\prime$ grafu $G$ poprzez zastąpienie wierzchołka $v$ w zbiorze $C$ przez wierzchołek $w$, czego wynikiem jest optymalne pokrycie wierzchołkowe grafu $G$ zawierające $N(v)$.
  \end{bproof}
  \begin{theorem}\thlabel{th_exclude_additional_neighbor}
    Dla pewnych wierzchołków $u$ oraz $v$ połączonych krawędzią $(u, v) \in E$ w grafie $G=(V, E)$ istnieje optymalne pokrycie wierzchołkowe grafu $G$ zawierające wierzchołek $v$ lub wykluczające wierzchołek $v$ oraz co najmniej jeden wierzchołek sąsiadujący z wierzchołkiem $u$.
  \end{theorem}
  \begin{bproof}
    Jeżeli każde optymalne pokrycie wierzchołkowe $C$ grafu $G$ wykluczałoby wierzchołek $v$, zawierając zarazem wszystkie wierzchołki sąsiadujące z wierzchołkiem $u$ w grafie $G$, to pokrycie $C$ musi również zawierać wierzchołek $u$ --- krawędź $(u, v)$ musi zostać pokryta.
    W tej sytuacji pokrycie $C^\prime=(C \setminus \{u\}) \bigcup \{v\}$ stanowiłoby zgodne z definicją~\ref{def_vc} optymalne pokrycie wierzchołkowe zawierające $v$, przeczące założeniu że każde optymalne pokrycie wierzchołkowe musi wykluczać wierzchołek $v$.
  \end{bproof}
  \begin{definition}
    W przypadku odnalezienia w grafie $G$ pewnej instancji $(G, k)$ problemu pokrycia wierzchołkowego zbioru $S$, który w całości przynależy do optymalnego pokrycia wierzchołkowego grafu $G$ lub też w całości jest z niego wykluczony mówi się, że algorytm \emph{rozgałęzia się na zbiorze $S$}.
    Oznacza to, iż algorytm konstruuje dwie zredukowane instancje problemu.
    \begin{enumerate}
      \item Instancja zawierająca zbiór $S$ w częściowym pokryciu wierzchołkowym.
      \item Instancja wykluczająca zbiór $S$ z częściowego pokrycia wierzchołkowego i zawierająca wszystkie wierzchołki sąsiadujące ze zbiorem $S$ w częściowym pokryciu wierzchołkowym.
    \end{enumerate}
    Jeżeli zbiór $S$ składa się z jednego wierzchołka $v$ mówi się, że algorytm \emph{rozgałęzia się na wierzchołku $v$}.
  \end{definition}
}
\subsubsection{\textbf{Operacja strukturyzacji}}\label{sss_ckx_struction}
\par{
  Wprowadzona przez autorów pracy~\cite{ImprovedBounds10} operacja strukturyzacji stanowi uściślenie operacji strukturyzacji występującej w~pracy~\cite{Ebengger:1984}.
  Operacja strukturyzacji jest pierwszą z podstawowych, nierozgałęziających się funkcji pomagających w utrzymywaniu ``czystej'' struktury grafu dla maksymalizacji efektywności algorytmu głównego.
  Operację tę szczegółowo opisuje pseudokod~\ref{alg_ckx_struction} w podrozdziale~\ref{sss_internals_ckx}.
}
\par{
  \begin{definition}
    Dla pewnych dwóch wierzchołków $u$ oraz $v$ grafu $G=(V, E)$ zbiór $\{u, v\}$ określa się mianem \emph{antykrawędzi} w grafie $G$ jeżeli $(u, v) \notin E$.
  \end{definition}

  Przyjąć należy pewien wierzchołek $v_0$ należący do grafu $G$ oraz posiadający zestaw wierzchołków sąsiednich $N(v_0)=\{v_1, v_2, \ldots, v_p\}$.
  Graf strukturyzowany $G^\prime$ konstruowany jest według następujących kroków.
  \begin{enumerate}
    \item Usuń wierzchołki $v_N \in N[v_0]$ z grafu G i dla każdej antykrawędzi $\{v_i, v_j\}$ w grafie $G$, gdzie $0 < i < j \leq p$ wprowadź nowy wierzchołek $v_{ij}$ do grafu strukturyzowanego $G^\prime$.
    \item Jeżeli $i=j, r\neq s$ oraz $(v_r, v_s) \in E$, dodaj do grafu strukturyzowanego $G^\prime$ krawędź $(v_{ir}, v_{js})$.
    \item Jeżeli $i \neq j$, dodaj do grafu strukturyzowanego $G^\prime$ krawędź $(v_{ir}, v_{js})$.
    \item Dla każdego wierzchołka $u \notin N[v_0]$ dodaj krawędź $(v_{ij}, u)$ jeżeli $(v_i, u) \in E$ lub $(v_j, u) \in E$.
  \end{enumerate}
  \begin{theorem}
    Dla pewnego wierzchołka $v_0$ grafu $G=(V, E)$ o sąsiedztwie $N(v_0); |N(v_0)|=p$ założyć należy istnienie co najwyżej $p-1$ antykrawędzi w zbiorze $N(v_0)$.
    Jeżeli za $G^\prime$ przyjmuje się graf otrzymany w yniku strukturyzacji wierzchołka $v_0$ w grafie $G$, to spełniona jest nierówność $\tau(G) \leq \tau(G^\prime) - 1$.
  \end{theorem}
  \begin{bproof}
    Przyjąć należy notację $\alpha(G)$ oraz $\alpha(G^\prime)$ jako oznaczenie liczebności największego zbioru niezależnego (w rozumieniu definicji~\ref{def_independent_set}) w grafach $G$ oraz $G^\prime$.
    W~pracy~\cite{Ebengger:1984} udowodniono, iż $\alpha(G^\prime)=\alpha(G) - 1$.
    Niech przez $n$ oraz $n^\prime$ oznaczone będą liczby wierzchołków odpowiednio grafu $G$ oraz $G^\prime$.
    W związku z założeniem, iż istnieje co najwyzej $p - 1$ antykrawędzi w zbiorze $N(v_0)$, liczba nowo utworzonych w grafie $G^\prime$ wierzchołków może wynosić co najwyżej $p - 1$.
    Ponieważ z grafu $G$ usunieto $p+1$ wierzchołków, to znaczy zbiór $N[v_0]$, łatwo zauważyć, iż $n^\prime \leq n-2$.
    Z charakterystyki zbioru niezależnego oraz pokrycia wierzchołkowego wywnioskować można, iż dla dowolnego grafu $H$ spełniona jest równość $\alpha(H)+\tau(H)=|H|$.
    Na podstawie powyższych obserwacji stwierdzić można, iż zachowana jest następująca własność.
    \[\tau(G^\prime)=n^\prime-\alpha(G^\prime)\leq (n-2)-(\alpha(G)-1)=\tau(G)-1\]
  \end{bproof}
}
\subsubsection{\textbf{Uogólniona operacja zwijania}}\label{sss_ckx_general_fold}
\par{
  Uogólniona operacja zwijania stanowi drugą z podstawowych, nieposiadających rozgałęzień procedur utrzymujących strukturę grafu w postaci spełniającej warunki umożliwiające maksymalizację efektywności działania algorytmu głównego.
  Wywodzi się ona z techniki przetwarzania wstępnego opartej na zwijaniu wierzchołków stopnia 2. wraz z sąsiedztwem.
  Metodologia postępowania tego algorytmu jest jednak podobna do techniki opisywanej w podrozdziale~\ref{Section_preprocessing} jedynie na poziomie konceptualnym.
  Uogólnienie jej czynności pozwalające na uwolnienie się od ograniczenia stopnia zwijanego wierzchołka do 2 wymaga sięgnięcia do koncepcji NT-dekompozycji oraz koron grafu.
}
\par{
  \begin{theorem}\thlabel{th_general_fold}
    Dla grafu $G=(V,E)$ założyć należy istnienie pewnego niezależnego zbioru $I\neq \emptyset$ o zbiorze wierzchołków sąsiednich $N(I)$.
    Dodatkowo założyć należy liczebność zbioru $|N(I)|=|I| + 1$ oraz dla każdego z podzbiorów $\emptyset \neq S \subseteq I$ liczebność sąsiedztwa $|N(S)| \geq |S| + 1$.
    Wobec takich założeń, następujące implikacje są prawdziwe.
    \begin{enumerate}
      \item Jeżeli graf zaindukowany z grafu $G$ zbiorem $N(I)$ (w rozumieniu definicji~\ref{def_induced_graph}) nie stanowi zbioru niezależnego oznacza to, że istnieje optymalne opkrycie wierzchołkowe zawierające zbiór $N(I)$ i nie zawierające zbioru $I$.
      \item Jeżeli graf zaindukowany z grafu $G$ zbiorem $N(I)$ stanowi zbiór niezależny, należy przyjąć graf $G^\prime=(V^\prime, E^\prime)$ uzyskany z grafu $G$ tak, że $V^\prime=V \setminus (I \bigcup N(I)) \bigcup \{u_I\}$ gdzie $u_I$ stanowi nowo dodany wierzchołek, który należy połączyć z każdym wierzchołkiem $v \in V^\prime$ sąsiadującym w grafie $G$ z dowolnym wierzchołkiem $u \in N(I)$.
      W przypadku spełnienia tych założeń prawdziwa jest równość $\tau(G^\prime)=\tau(G)-|I|$.
    \end{enumerate}
  \end{theorem}
  \begin{bproof} W celu udowodnienia poprawności operacji należy wpierw ugruntować fundamenty teoretyczne łączące strukturę $(I, N(I))$ z pokryciem wierzchołkowym. Ich prawidłowości dowodzi część (0).
    Następujące części kolejno dowodzą przypadków opisanych twierdzeniem.
    \begin{itemize}
      \item[(0):] Dla grafu $G=(V, E)$ istnieje optymalne pokrycie wierzchołkowe $C$ zawierające zbiór $N(I)$ oraz wyłączające zbiór $I$.
      Przyjąć należy zbiory $\emptyset \neq X=C \bigcap I$ oraz $\emptyset \neq Y=C \bigcap N(I)$.
      Ponieważ zbiór $C$ stanowi pokrycie wierzchołkowe grafu $G$ widocznym jest, że jeżeli $X=\emptyset$ to wtedy $Y=N(I)$ --- podobnie jak i w sytuacji gdyby $Y=\emptyset$, wtedy $X=I$.
      Pozwala to przyjąć założenie, że zarówno $X\neq \emptyset$ jak i $Y\neq \emptyset$.
      Ponownie z założenia, że zbiór $C$ stanowi pokrycie wierzchołkowe grafu $G$ stwierdzić można, iż zachodzi $N(I-X)\subseteq Y$.
      W sytuacji gdy $I \supset X$, założenia twierdzenia dotyczące rozmiarów zbioru sąsiedztwa $N(I)$ pozwala stwierdzić, że prawdziwa jest nierówność $|Y| \geq |N(I \setminus X)| \geq |I \setminus X| + 1 = |I| - |X| + 1$.
      W sytuacji gdy $I = X$, w związku z faktem, że $Y \neq \emptyset$, tak jak w poprzednim przypadku spełniona jest nierówność $|Y|\geq|I|-|X|+1$.
      Ponieważ zbiór $I$ jest niezależny w grafie $G$, zastąpienie zbioru $Y \bigcup X$ zbiorem $N(I)$ w pokryciu wierzchołkowym $C$ owocuje pokryciem wierzchołkowym $C^\prime$ grafu $G$ o liczebności $|C^\prime| \leq |C|$.
      Wobec tego toku rozumowania łatwo zauważyć, że zbiór $C^\prime$ stanowi pokrycie wierzchołkowe grafu $G$ o najmniejszej liczebności, które zawiera zbiór $N(I)$ oraz wyłącza zbiór niezależny $I$.
      \item[(1):] Założyć należy istnienie pokrycia wierzchołkowego $C$ spełniającego założenia części (0) dowodu.
      Jeżeli graf zaindukowany z grafu $G$ zbiorem $N(I)$ nie stanowi zbioru niezależnego oznacza to, że każde z istniejących pokryć wierzchołkowych grafu $G$, a w szczególności zbiór $C$, musi zawierac zbiór $N(I)$.
      Prowadzi to do wniosku, że zbiór $C$ stanowi optymalne pokrycie wierzchołkowe grafu $G$ zawierające zbiór $N(I)$ i wykluczające zbiór niezależny $I$.
      \item[(2):] Jeżeli zbiór $N(I)$ stanowić miałby zbiór niezależny w grafie $G$ to w sytuacji gdy zachodzi $C \supseteq I$, zbiór $C$ musiałby jednocześnie wykluczać zbiór $N(I)$ oraz zawierać zbiór $N(N(I))$ w grafie $G^\prime$.
      W takim przypadku zbiór $C^\prime=C \setminus I$ stanowi pokrycie wierzchołkowe grafu $G^\prime$ o liczebności $|C|-|I|=\tau(G)-|I|$ oraz spełniona jest nierówność $\tau(G^\prime)\leq\tau(G)-|I|$ \textit{(2.1)}.

      W sytuacji gdzie zachodzi $C \supseteq N(I)$, zbiór $C^\prime=(C \setminus N(I))\bigcup\{u_I\}$ stanowi pokrycie wierzchołkowe grafu $G^\prime$ o liczebności $\tau(G)-(|I|+1)+1=\tau(G)-|I|$ oraz ponownie spełniona jest nierówność $\tau(G^\prime)\leq\tau(G)-|I|$ \textit{(2.2)}.

      Patrząc z perspektywy wierzchołka $u_I$, jeżeli zbiór $C^\prime$ stanowi optymalne pokrycie wierzchołkowe grafu $G^\prime$, musi on albo zawierać wierzchołek $u_I$ albo wykluczać wierzchołek $u_I$ zawierać zbiór jego sąsiedztwa $N(u_I)$.
      Jeżeli zbiór $C^\prime$ zawiera wierzchołek $u_I$, wtedy zbiór $(C^\prime - \{u_I\}) \bigcup N(I)$ stanowi pokrycie wierzchołkowe grafu $G$ o liczebności $|C^\prime|+|I|$, co powoduje spełnienie nierówności $\tau(G^\prime)\geq \tau(G)-|I|$ \textit{(2.3)}.

      Jeżeli zbiór $C^\prime$ wyklucza wierzchołek $u_I$, zawierając jednocześnie zbiór jego sąsiedztwa $N(u_I)$, wtedy zbiór $C^\prime$ ponownie stanowi pokrycie wierzchołkowe grafu $G$ o liczebności $|C^\prime|+|I|$ i ponownie spełniona jest nierówność $\tau(G^\prime)\geq \tau(G)-|I|$ \textit{(2.4)}.

      Powyższy tok rozumowania dowodzi, że w sytuacji (2) zawsze będzie mieć miejsce po jednym przypadku z par \textit{(2.1)}, \textit{(2.2)} oraz \textit{(2.3)}, \textit{(2.4)}.
      Bez względu na konfigurację mających miejsce przypadków, w sytuacji tej niezmiennie spełniona jest równość $\tau(G^\prime)=\tau(G)-|I|$.
    \end{itemize}
  \end{bproof}

  \begin{definition}
    Uporządkowana para $(I, H=(N(I)))$ opisywana twierdzeniem~\ref{th_general_fold} nosi miano~\emph{pseudokorony}.
  \end{definition}

  Należy zaobserwować, że struktura pseudokorony nie jest koroną gdyż nie spełnia ona postulowanych w definicji~\ref{def_crown} założeń odnośnie rozmiaru zbiorów składowych, to znaczy nierówności $|H| \leq |I|$.
  Wiąże się to z faktem, iż graf wolny od koron może zawierać pseudokoronę --- obserwacja ta stanowi klucz do uogólnienia logiki procedury zwijania.
}
\par{
  Tok rozumowania definiujący proces poszukiwań pseudokoron w grafie posługuje się skrótem myślowym dotyczącym skojarzenia składowego zbioru niezależnego z głową odnalezionej pseudokorony. 
  Fundamenty poprawności tego uproszczenia ugruntowane są w twierdzeniu Halla, którego dowód jest poza zakresem niniejszej pracy --- twierdzenie jest jednak fundamentalnym elementem wielu prac oraz kursów uczelnianych co powoduje, iż nietrudno tenże dowód odnaleźć w ogólnodostępnej literaturze.
  Zastosowane w przytoczonej treści twierdzenia Halla oznaczenia są spójne z konwencjami wprowadzonymi na początku podrozdziału~\ref{s_ckx}.
  \begin{theorem}[Twerdzenie Halla]\thlabel{th_hall}
    Dla dwudzielnego grafu $G$ o podziale $(A, B)$ skojarzenie pokrywające całość zbioru $A$ może istnieć wtedy i tylko wtedy jeżeli każdy podzbiór $X \subseteq A$ spełnia własność $|N(X)| \geq |X|$.
  \end{theorem}

  Krokiem kluczowym dla odnalezienia struktury pseudokorony w nieposiadającym koron grafie $G$ jest istnienie pewnego wierzchołka $v$, który stanowi jedyny wierzchołek czyniący strukturę grafu $G$ wolną od koron, czego analiza przeprowadzona zostaje w ramach dowodu następującego twierdzenia.

  \begin{theorem}\thlabel{th_almost_crown}
    Wolny od koron graf $G=(V, E)$ zawiera pseudokoronę wtedy i tylko wtedy, jeżeli istnieje wierzchołek $v \in V$ taki, że graf zaindukowany z grafu $G$ zbiorem $V\setminus \{v\}$ zawiera równą koronę (w rozumieniu definicji~\ref{def_equal_crown}).
  \end{theorem}
  \begin{bproof}
    Zakładając, iż graf $G$ posiada pseudokoronę $(I, H=N(I))$, spełnione muszą być własności $|H| = |I| + 1$ oraz $\forall_{\emptyset\neq S \subseteq I}:{|N(S)|\geq|S|+1}$.
    Przyjąć za dane należy dowolny wierzchołek $v \in H$ oraz zbiór $H^\prime=H \setminus \{v\}$ --- w takiej sytuacji spełniona jest równość $|H^\prime|=|I|$.
    Łatwo zauważyć, że w tym przypadku $(I, H^\prime)$ stanowi równą koronę w grafie $G^\prime$ zaindukowanym z grafu $G$ zbiorem $V \setminus \{v\}$.
    W konsekwencji widać, że w grafie $G^\prime$ musi zachodzić równość $H^\prime = N(I)$.
    W związku z faktem, że graf $G$ nie zawiera żadnej korony, dla każdego niepustego podzbioru $S \subseteq I$ spełniona w grafie $G$ jest nierówność $|N(S)| \geq |S|+1$, co z kolei implikuje, że dla każdego ze zbiorów $S$  w grafie $G^\prime$ zachodzi nierówność $|N(S)| \geq |S|$.
    Twierdzenie~\ref{th_hall} pozwala stwierdzić, że zbiór $I$ kojarzy zbiór $H^\prime$ a zatem, na mocy równości $|H^\prime|=|I|$, zbiór $H^\prime$ musi w ten sam sposób kojarzyć zbiór $I$, co dopełnia definicji równej korony i dowodzi, że graf $G^\prime$ musi taką koronę zawierać.

    Spoglądając z innej perspektywy --- utrzymując założenie, że graf $G$ nie zawiera koron i istniej wierzchołek $v \in V$, taki że graf $G^\prime$ zaindukowany z grafu $G$ zbiorem $V \setminus \{v\}$ posiada równą koronę $(I, H^\prime)$ postuluje się, iż struktura $(I, H=H^\prime \bigcup\{v\})$ stanowi pseudokoronę w grafie $G$.
    Zaobserwować należy, iż wierzchołek $v$ musi należeć do zbioru $N(I)$ w grafie $G$ --- w przeciwnym wypadku w grafie $G$ spełniona musiałaby być równość $H^\prime=N(I)$, w wyniku czego struktura $(I, H^\prime)$ musiałaby stanowić koronę w grafie $G$, co przeczy założeniu o braku koron w grafie $G$.
    W konsekwencji stwierdzić można, że w grafie $G$ spełnione są własności $H=N(I)$ oraz $|H|=|I|+1$.
    Zakładając istnienie niepustego podzbioru $S \subseteq I$ oraz mając na uwadze fakt, iż struktura $(I, H^\prime)$ stanowi równą koronę w grafie $G^\prime$ i zbiór $I$ jest w pełni skojarzony ze zbiorem $H^\prime$ stwierdzić można, że $|N(S) \geq |S|$ w grafie $G^\prime$.
    W tej sytuacji, w przypadku gdy wierzchołek $v$ sąsiaduje w grafie $G$ ze zbiorem $N(S)$, spełniona jest nierówność $|N(S)| \geq |S| + 1$.
    W przeciwnym wypadku, to znaczy gdy wierzchołek $v \notin N(S)$, zbiór $N(S)$ jest identyczny zarówno w grafie $G$ jak i $G^\prime$.
    Jeżeli zatem spełnione jest równanie $|N(S)|=|S|$ --- w związku z faktem, iż zbiór $S$ jest skojarzony ze zbiorem $N(S)$, musiałoby to oznaczać, że zbiór $N(S)$ jest skojarzony ze zbiorem $S$.
    W konsekwencji struktura $(S, N(S))$ musiałaby stanowić koronę w grafie $G$, co przeczy założeniu, iż nie posiada on żadnej korony.
    Wobec tej sprzeczności jeżeli wierzchołek $v$ nie sąsiaduje ze zbiorem $S$ w grafie $G$, to spełniona musi być właściwość $|N(S)| \geq |S| + 1$.

    W efekcie, bez względu na to czy wierzchołek $v$ sąsiaduje ze zbiorem $S$ czy nie, nierówność $|N(S)| \geq |S| + 1$ jest spełniona dla każdego niepustego podzbioru $S \subseteq I$ --- co zaświadcza, iż struktura $(I, H=N(I))$ stanowi pseudokoronę w grafie G.
  \end{bproof}

  Jak wspomniano wcześniej, uogólniona operacja zwijania posługuje się strukturami realizującymi koncepcje NT-dekompozycji i koron.
  Celem operacji jest jak największa redukcji dziedziny problemu, możliwa w danym momencie realizacji aktualnej gałęzi algorytmu głównego.
  Algorytm realizujący uogólnioną operację zwijania musi zatem pozbyć się z aktualnej postaci grafu wszystkich struktur koron i pseudokoron.

  \begin{theorem}
    Istnieje algorytm $\mathcal{A}$ o złożoności $O(k^3\sqrt{k})$ redukujący dowolną instancję $(G=(V, E), k)$ problemu pokrycia wierzchołkowego o rozmiarze $|V|\leq 2k$ do nieposiadającej koron ani pseudokoron instancji $(G^\prime=(V^\prime, E^\prime), k^\prime)$ o parametrach $|V^\prime| \leq |V|$ oraz $k^\prime \leq k$.
  \end{theorem}
  \begin{bproof}
    W celu usnięcia struktur koron z grafu, należy aplikować na grafie NT-dekompozycje do momentu otrzymania trywialnej instancji takiej dekompozycji (w rozumieniu definicji~\ref{def_nt_decomposition_trivial}).
    Zgodnie z drugim twierdzeniem Nemhausera-Trottera~\ref{nt_lp}, każde zastosowanie NT-dekompozycji wymaga $O(|V|\sqrt{|E|})$ czasu.
    W związku z udowodnieniem, iż rozmiary grafu w rozpatrywanej instancji problemu pokrycia wierzchołkowego wynoszą odpowiednio $|V|=O(k)$ oraz $|E|=O(k^2)$ łatwo zauważyć, że każda NT-dekompozycja zajmie tak naprawdę $O(k^2\sqrt{k})$ czasu.
    Każda z NT-dekompozycji redukuję dziedzinę grafu a zatem do momentu uzyskania trywialnej instancji NT-dekompozycji operacja wykonana zostanie $O(k)$ razy.
    Po tym czasie załozyć można, iż zredukowany graf nie posiada żadnych koron, zgodnie z~twierdzeniem~\ref{th_crown_free_graph}.
    Łatwo zaobserwować, że w czasie $O(k^3\sqrt(k))$ można zredukować instancję $(G, k)$ problemu pokrycia wierzchołkowego do instancji $(G^\prime, k^\prime)$, gdzie graf $G^\prime$ nie zawiera żadnych koron.
    Należy również zauważyć, że każda aplikacja NT-dekompozycji owocująca nietrywialną jej instancją powoduje zmniejszenie parametru $k$ o wartość odpowiadającą szerokości korony (w rozumieniu definicji~\ref{def_crown_head}) zawartej w danej instancji.

    Podążając za dowodem twierdzenia~\ref{th_almost_crown}, struktura pseudokorony może istnieć w grafie $G^\prime$ wtedy i tylko wtedy, kiedy zawiera on wierzchołek $v$ taki, że graf zaindukowany z grafu $G^\prime$ zbiorem $V \setminus \{v\}$ zawiera równą koronę.
    Sposób odnalezienia pseudokorony polega zatem na przeprowadzeniu NT-dekompozycji na grafie zaindukowanym z grafu $G^\prime$ zbiorem $V \setminus \{v\}$ dla każdego wierzchołka $v \in G^\prime$.
    Jeżeli dowolna z przeprowadzonych NT-dekompozycji owocuje instancją korony, na mocy twierdzenia~\ref{th_almost_crown} musi to być korona równa --- w przeciwnym wypadku graf $G^\prime$ musiałby zawierać koronę.
    W efekcie odkryta została struktura pseudokorony, to znaczy wierzchołka $v_c$ wraz z koroną otrzymaną z NT-dekompozycji grafu zaindukowanego z grafu $G^\prime$ zbiorem $V \setminus \{v_c\}$.
    Operacja odnalezienia pseudokorony zajmuje $O(k^{\prime}^3\sqrt{k^\prime})=O(k^3\sqrt{k})$ czasu, ponieważ należy przeprowadzić co najwyżej $O(k)$ NT-dekompozycji dla zaindukowanych grafów.

    Po wykonaniu powyższych operacji otrzymany graf nie zawiera koron ani pseudokoron.
    W oparciu  otwierdzenie~\ref{th_crown_domain_reduction} można stwierdzić, że rozmiar wynikowej instancji problemu wynosi $|V^\prime| \leq 2k^prime$.
  \end{bproof}
}
\subsubsection{\textbf{Struktury ``pożyteczne''}}
\label{sss_ckx_structures}
\par{
  Identyfikacja struktur ``pożytecznych'' (zwanych również po prostu \emph{strukturami}) w grafie związanym z rozpatrywaną instancją problemu pokrycia wierzchołkowego pozwala na maksymalizację efektywności procesu redukcji dziedziny do jądra problemu, co przekłąda się bezpośrednio na zmniejszenie złożoności czasowej algorytmu. Klasy struktur wraz z priorytetami zostały przez autorów pracy~\cite{ImprovedBounds10} wyznaczone drogą analityczną w oparciu o identyfikację i dekonstrukcję możliwie występujących w ogólnych grafach przypadków mających znaczenie dla parametryzowanego wariantu problemu pokrycia wierzchołkowego.
  Wartość ``pożyteczności'' danej klasy struktur określana jest przede wszystkim na podstawie relacji pomiędzy składającymi się na nie wierzchołkami.
}
\par{
  Bardzo intensywnie wykorzystywanym w identyfikacji struktur pojęciem jest \emph{dominacja} oraz \emph{pseudodominacja} zachodząca pomiędzy wierzchołkami.
  \begin{definition}\thlabel{def_domination}
    W grafie $G=(V, E)$ pewien wierzchołek $u$ jest \emph{zdominowany} przez pewien wierzchołek $v$ (wierzchołek $v$ \emph{dominuje} nad wierzchołkiem $u$) jeżeli są one połączone krawędzią $(u, v) \in E$ oraz zachodzi własność $N(u) \subseteq N[v]$.
    W celu uproszczenia zapisu dla wyrażenia dominacji wierzchołka $v$ nad wierzchołkiem $u$ stosowana będzie notacja $v \ddagger u$.
  \end{definition}
  \begin{definition}\thlabel{def_almost_domination}
    W grafie $G=(V, E)$ pewien wierzchołek $u$ jest \emph{pseudozdominowany} przez pewien wierzchołek $v$ (wierzchołek $v$ \emph{pseudodominuje} nad wierzchołkeiem $u$) jeżeli są nie one połączone krawędzią $(u, v) \notin E$ oraz zachodzi własność $|N(u) \setminus N(v)| \leq 1$.
    W celu uproszczenia zapisu dla wyrażenia pseudodominacji wierzchołka $v$ nad wierzchołkiem $u$ stosowana będzie notacja $v \dagger u$.
  \end{definition}
  \begin{theorem}
      Jeżeli w grafie $G=(V, E)$ pewien wierzchołek $v$ dominuje nad pewynm wierzchołkiem $u$, to istnieje optymalne pokrycie wierzchołkowe grafu $G$ zawierające wierzchołek $v$.
  \end{theorem}
  \begin{bproof}
    Jeżeli pewne optymalne pokrycie wierzchołkowe $C$ nie zawiera wierzchołka $v$, musi zatem zawierać zbiór jego wierzchołków sąsiednich $N(v)$, który zawiera wierzchołek $u$ (w oparciu o definicję~\ref{def_domination}).
    W zawiązku z faktem, iż zbiór $(N(u) \setminus \{v\})$ jest zawarty w zbiorze $N(v)$, zastąpienie wierzchołka $u$ przez $v$ w zbiorze $C$ owocuje optymalnym pokryciem wierzchołkowym zawierającym wierzchołek $v$.
  \end{bproof}
}
\par{
  Kolejną szczególną klasą struktur są tak zwane \emph{dobre pary}.
  Głównym zastosowaniem dobrych par jest maksymalizacja efektywności redukcji dziedziny w momencie rozgałęziania się głównego algorytmu.
  \begin{definition}
    W grafie $G=(V, E)$ mianem \emph{dobrej pary} nazywa się parę wierzchołków $\{u, z\}$ wybranych wedle następujących kryteriów.
    Dla każdego wierzchołka $u \in V$ posiadającego zbiór wierzchołków sąsiednich $N(u)=\{u_1, u_2, \ldots, u_d\}$ zdefiniować należy jego \emph{etykietę} (zapisywaną jako \emph{etykieta(u)}) jako wektor $\eta=\<\eta_1, \eta_2, \ldots, \eta_d\>$, gdzie $\eta_1$ stanowi stopień wierzchołka sąsiadującego z wierzchołkiem $u$ o największym stopniu $u_{a} \in N(u), d(u_{a})=\max\{d(u_n) | u_n \in N(u)\}$, $\eta_2$ jest stopniem wierzchołka sąsiadującego z wierzchołkiem $u$ o drugim w kolejności największym stopniu $u_{b} \in N(u), d(u_{b})=\max\{d(u_n) | u_n \in N(u) \setminus \{u_{a}\}\}$ itd. --- $\eta_d$ stanowi stopień wierzchołka sąsiadującego z wierzchołkiem $u$ o najniższym stopniu spośród wszystkich wierzchołków zbioru $N(u)$ $u_{z} \in N(u), d(u_{z})=\min\{d(u_n) | u_n \in N(u)\}$.

    W celu określenia pierwszego wierzchołka pewnej dobrej pary należy wybrać wierzchołek $u \in V$ spełniający następujące własności w podanym porządku.
    \begin{enumerate}[(i)]
      \item Wektor etykiety wierzchołka $u$ jest największy w porządku leksykograficznym spośrów wektorów etykiet wszystkich wierzchołków $w \in G$ stopnia $d(w)=d(u)$.
      \item  Jeżeli graf $G$ jest regularny (w rozumieniu definicji~\ref{def_regular}), liczba par wierzchołków $\{x, y\} \subseteq N(u)$, w których wierzchołek $y$ jest pseudozdominowany przez wierzchołek $x$ jest największa z możliwych.
      \item Liczba krawędzi w ramach zbioru $N(u)$ jest największa z możliwych.
    \end{enumerate}

    W celu identyfikacji drugiego wierzchołka pewnej dobrej pary należy wybrać wierzchołek $z \in N(u)$ spełniający następujące własności w podanym porządku.
    \begin{enumerate}[(a)]
      \item Jeżeli istnieją pewne dwa wierzchołki $v \in N(u)$ oraz $w \in N(u)$, z których wierzchołek $v$ jest pseudozdominowany przez wierzchołek $w$, to wierzchołek $z$ jest pseudozdominowany przez pewien wierzchołek $x \in N(u)$.
      \item Stopień wierzchołka $d(z)$ jest największy z możliwych wśród wierzchołków sąsiadujących z wierzchołkiem $u$, spełniających własność (a).
      W sytuacji gdy żaden wierzchołek $v \in N(u)$ nie pseudodominuje żadnego innego wierzchołka $w \in N(u)$, własność (a) jest spełniona w sposób przechodni przez każdy wierzchołek sąsiadujący z wierzchołkiem $u$ --- woerzchołek $z$ będzie wtedy po prostu sąsiadem największego stopnia wierzchołka $u$.
      \item Wierzchołek $z$ jest połączony krawędzią z jak najmniejszą liczbą wierzchołków należących do sąsiedztwa wierzchołka $u$ spośród wszystkich wierzchołków, dla kórych zachodzą własności (a) i (b).
      \item Liczba wierzchołków sąsiednich współdzielonych pomiędzy wierzchołkiem $z$ oraz innym wierzchołkiem nalężącym do sąsiedztwa wierzchołka $u$ jest największa z możliwych spośród wszystkich elementów zbioru $N(u)$, dla których zachodzą własności (a), (b) i (c).
    \end{enumerate}
  \end{definition}
}
\subsubsection{Krotki}
\label{sss_ckx_tuples}
\par{
  Szczególnie ważną klasę identyfikowanych w grafie struktur z punktu widzenia redukcji przestrzeni poszukiwań stanowią \emph{krotki}.
  \begin{definition}
    Mianem \emph{krotki} określa się uporządkowaną parę $(S, q)$, gdzie $S$ stanowi zbiór wierzchołków, a wartość $q$ jest liczbą całkowitą.
    Krotka niesie ze sobą informację, że w aktualnie rozpatrywanej instancji problemu pokrycia wierzchołkowego $(G, k)$ można prowadzić poszukiwania optymalnego pokrycia wierzchołkowego z wyłączeniem co najmniej $q$ wierzchołków należących do zbioru $S$.
  \end{definition}
  W praktyce algorytm rozpatruje wyłącznie krotki $(S, q)$ dla wartości $q \leq 2$ --- wyłącznie na nich skupiona jest również analiza.
  Najbardziej wartościowym podzbiorem krotek są tak zwane \emph{2-krotki} oraz \emph{silne 2-krotki}.
  \begin{definition}
    Krotka $(S, q)$ określana jest mianem \emph{2-krotki}, jeżeli zbiór $S$ ma postać $S=\{u, v\}$ oraz spełnione są następujące warunki.
    \begin{enumerate}
      \item $q=1$.
      \item $d(u) \geq d(v)$.
      \item $(u, v) \notin E$.
    \end{enumerate}
  \end{definition}
  \begin{definition}
    2-krotka $(S, q)$ stanowi \emph{silną 2-krotkę} jeżeli spełnia jeden z następujących warunków.
    \begin{enumerate}
      \item $d(u) \geq 4 \land d(v) \geq 4$.
      \item $2 \leq d(u) \leq 3 \land 2 \leq d(v) \leq 3$.
    \end{enumerate}
  \end{definition}
}
\par{
  Aby uwidocznić wysoką wartość krotek, należy wytłumaczyć w jaki sposób algorytm wykorzystuje te struktury podczas rozgałęziania.
  Dla potrzeb wyjaśnienia przyjąc należy, że algorytm rozgałęzia się na pewnym wierzchołku $z$ o sąsiedztwie $N(z)$.
  Na podstawie obserwacji dokonanej w ramach twierdzenia~\ref{th_include_neighborhood} stwierdzić można, że istnieje optymalne pokrycie wierzchołkowe grafu $G$ zawierające zbiór $N(z)$ lub wykluczające co najmniej dwa wierzchołki należące do tego zbioru.
  Wobec tego w momencie rozgałęziania algorytmu, w instancji zawierającej wierzchołek $z$ przestrzeń poszukiwań może zostać ograniczona do pokrycia wierzchołkowego zbioru wykluczającego co najmniej dwa wierzchołki należące do sąsiedztwa wierzchołka $z$ --- istnieje pewność poprawności takiej operacji, ponieważ jeżeli takie pokrycie nie istnieje, druga gałąź rozpatrująca instancję zawierającą całość zbioru $N(z)$ odnajdzie optymalne pokrycie wierzchołkowe jeżeli takowe istnieje.
  Pojęcie wykluczenia co najmniej dwóch wierzchołków sąsiadujących z wierzchołkiem $z$ jest materializowane przez stworzenie w momencie rozgałęziania krotki $(N(z), q=2)$.

  W sytuacji gdy algorytm rozgałęzia się na pewnym wierzchołku $z$ posiadającym pewien sąsiedni wierzchołek $u$, zgodnie z obserwacją dokonaną w ramach twierdzenia~\ref{th_exclude_additional_neighbor} musi istnieć optymalne pokrycie wierzchołkowe, które albo zawiera wierzchołek $z$ albo wyklucza wierzchołek $z$ oraz co najmniej jeden wierzchołek należący do sąsiedztwa wierzhołka $u$.
  Przestrzeń poszukiwań w ramach tej gałęzi algorytmu może być zatem ograniczona do zbioru wykluczającego co najmniej dwa wierzchołki należące do zbioru $N(u)$.
  Pojęcie wykluczenia tychże wierzchołków materializowane jest poprzez utworzenie w momencie rozgałęziania krotki $(N(u), q=2)$.
}
\subsubsection{\textbf{Aktualizacja krotek}}
\label{sss_ckx_updating_tuples}
\par{
  Krotki odzwierciedlają szczególne własności zachodzące w strukturze grafu w momencie pewnego rozgałęzienia algorytmu, są jednak utrzymymwane w kolejce priorytetowej struktur przez okres czasu mogący obejmować więcej niż jedno rozgałęzienie.
  W związku z faktem, iż krotka narzuca pewne ograniczenia na postać poszukiwaneg optymalnego pokrycia wierzchołkowego, należy dbać o to by stan krotek odzwierciedlał wszelkie zmiany zachodzące w strukturze grafu w związku z działaniami wykonywanymi na innych strukturach, które mają wpływ na wierzchołki zawarte w tychże krotkach.
}
\par{
  Przyjmując istnienie pewnej krotki $(S, q)$, jeżeli wartość $q = 0$, krotkę tę należy usunąć z kolejki priorytetowej, ponieważ reprezentowana przez nią własność spełniona jest przez dowolne pokrycie wierzchołkowe.
  \begin{theorem}
    Jeżeli pewien wierzchołek $v \in S$ zostanie usunięty z dziedziny poszukiwań przez wykluczenie go z pokrycia wierzchołkowego, krotka musi zostać uaktualniona przez usunięcie wierzchołka $v$ ze zbioru $S$ oraz dekrementację wartości $q$.
  \end{theorem}
  \begin{bproof}
    Jeżeli istnieje optymalne pokrycie wierzchołkwe $C$, które wyklucza co najmniej $q$ wierzchołków należących do zbioru $S$, wtedy pokrycie $C$ musi wykluczać co najmniej $q-1$ wierzchołków ze zbioru $S \setminus \{v\}$.
  \end{bproof}
  \begin{theorem}
    Jeżeli pewien wierzchołek $v \in S$ zostanie usunięty z dziedziny poszukiwań przez włączenie go do pokrycia wierzchołkowego, krotka musi zostać uaktualniona przez usunięcie wierzchołka $v$ ze zbioru $S$, a wartość $q$ nie ulega zmianie.
  \end{theorem}
  \begin{bproof}
    Jeżeli istnieje optymalne pokrycie wierzchołkowe $C$ zawierające wierzchołek $u$ oraz wyłączające co najmniej $q$ wierzchołków ze zbioru $S$, to musi ono wykluczać co najmniej $q$ wierzchołków ze zbioru $S \setminus \{v\}$.
  \end{bproof}
}
\par{
  Bardziej radykalne działania wymagane są w przypadku wykonania operacji wprowadzających ograniczenia struktury grafu wchodzące konflikt z ograniczeniami przedstawianymi przez istniejące krotki.
  Operacje, w wyniku których powstają ograniczenia wchodzące w konflikt z ograniczeniami przedstawianymi przez istniejące krotki związanymi z postacią poszukiwanego optymalnego pokrycia wierzchołkowego to tworzenie nowych krotek, operacja strukturyzacji oraz uogólniona operacja zwijania.
  Przykładowo, uogólniania operacja zwijania zakłada, że poszukiwane jest optymalne pokrycie wierzchołkowe zawierające niezależny zbiór $I$ lub jego sąsiedztwo dla odnalezionej struktury $(i, H=N(I))$ --- stanowi to podstawową własność umożliwiającą zwinięcie zbioru $N(I)$.
  Zwinięcie dowolnego takiego zbioru może pozostawić wynikową strukturę grafu w konflikcie z ograniczeniami narzucanymi przez niektóre istniejące już krotki.
  W związku z bardzo dużą iczbą potencjalnych sytuacji, w których tego typu konflikt możę następować, algorytm zaprojektowany w pracy~\cite{ImprovedBounds10} zakłada, iż po każdym zastosowaniu operacji strukturyzacji lub uogólnionej operacji zwijania, wszystkie istniejące krotki zostaną usunięte z kolejki priorytetowej.

  W celu weryfikacji możliwości zastosowania operacji strukturyzacji lub uogólnionej operacji zwijania należy sprawdzić czy redukcja parametru $k$ wynikająca z ich zastosowania będzie większa niż redukcja otrzymana z rozgałęzienia algorytmu na aktualnie rozpatrywanej krotce.
  W tym celu wprowadzone zostały dwie dodatkowe procedury weryfikujące te własności i na tej podstawie warunkowo dokonujące aplikacji wyżej wymienionych operacji.
}
\subsection{Algorytm główny}
\label{ss_ckx_vc}
\par{
  Algorytm rozwiązujacy parametryzowany wariant problemu pokrycia wierzchołkowego przedstawiony w pracy~\cite{ImprovedBounds10} działa zgodnie z pseudokodem~\ref{alg_ckx}.
   \begin{algorithm}
    \caption{Algorytm rozwiązujący problem pokrycia wierzchołkowego według Chen, Kanj, Xia}\label{alg_ckx}
    \begin{algorithmic}[1]
      \Function{VC}{$G$, $T$, $k$}

        \algorithmicrequire{Graf wejściowy $G=(V, E)$, kolejka priorytetowa $T$ struktur, parametr ograniczający $k$}

        \algorithmicensure{Liczebność ($\leq k$) optymalnego pokrycia wierzchołkowego grafu $G$ jeżeli takowe istnieje lub zgłoszenie porażki}

        \If{$k \leq 7$}
        \State{Rozwiąż instancję metodą siłową i zakończ działanie}
        \EndIf
        \State$\Call{Redukcja}$
        \State{Wybierz strukturę $\Gamma$ o najwyższym priorytecie z kolejki $T$}
        \If {$(\Gamma$ jest 2-krotką $(\{u, z\}, 1))$ \textbf{ or }\\
             \hspace{2.6em}($\Gamma$ jest dobrą parą $(u, z)$ gdzie $z\dagger v\in N(u))$ \textbf{or}\\
             \hspace{2.6em}($\Gamma$ jest wierzchołkiem $z$ stopnia $d(z) \geq 7$)}
          \State{\textbf{return} $\min\{1+\Call{VC}{G \setminus \{z\}, T \bigcup (N(z), 2), k-1},$\label{ckx_tuple_1}\\
                                       \hspace{8.9em}$ d(z) + \Call{VC}{G \setminus N[z], T, k - d(z)}\}$}
        \Else\Comment{$\Gamma$ jest dobrą parą $(u, z)$ gdzie $\neg(z \dagger v \in N(u))$}
          \State{\textbf{return} $\min\{1+\Call{VC}{G \setminus \{z\}, T, k-1},$\\
                                       \hspace{8.9em}$d(z) + \Call{VC}{G \setminus N[z], T \bigcup (N(u), 2), k - d(z)}\}$}\label{ckx_tuple_2}
        \EndIf
      \EndFunction
    \end{algorithmic}
  \end{algorithm}

  Wewnątrz głównej funkcji \textsc{VC} zdefiniowane są następujące funkcje pomocnicze.
  \begin{itemize}
    \item Funkcja \textsc{Redukcja}, działająca zgodnie z pseudokodem~\ref{alg_ckx_reduction}.
    \item Funkcja \textsc{War\_Zwijanie}, działająca zgodnie z pseudokodem~\ref{alg_ckx_conditional_gf}.
    \item Funkcja \textsc{War\_Strukt}, działająca zgodnie z pseudokodem~\ref{alg_ckx_conditional_struction}.
  \end{itemize}

  Do zadań funkcji pomocniczej \textsc{Redukcja} należy dekompozycja istniejących krotek do odpowiadających im nowych 2-krotek, redukcja przestrzeni poszukiwań przez wykonywanie operacji strukturyzacji i uogólnionej operacji zwijania na grafie, a także utrzymywanie odpowiedniego stanu kolejki $T$ w celu uniknięcia konfliktów pomiędzy ograniczeniami nałożonymi na aktualnie rozpatrywaną instancję problemu przez kolejne redukcje dziedziny.

  \begin{algorithm}
   \caption{Algorytm Chen, Kanj, Xia --- funkcja \textsc{Redukcja}}\label{alg_ckx_reduction}
   \begin{algorithmic}[1]
    \Function{Redukcja}{}
      \ForAll$(S, q) \in T$
        \If{$|S|<q$}
          \State{Odrzuć krotkę $(S, q)$}
        \EndIf
        \ForAll{$u \in S$}
          \State$T \gets T \bigcup \{(S \setminus \{u\}, q-1)\}$\label{a2}\Comment{Dekompozycja krotki}
        \EndFor
        \If{$S$ nie jest zbiorem niezależnym w $G$}
          \State$T \gets T \cup (\bigcup_{(u, v) \in E; u,v \in S}\{(S \setminus \{u, v\}, q-1)\})$\label{a3}\Comment{Dekomp. krotki}
        \EndIf
        \If{$\exists_{v \in V}: |N(v) \bigcap S|\geq |S| - q + 1$}\label{a4}
          \State{\textbf{return} $(1 + $VC($G \setminus \{v\}, T, k-1$)$)$}
        \EndIf
      \EndFor
      \If{\textsc{War\_Zwijanie}($G$) \textbf{or} \textsc{War\_Strukt}($G$) są aplikowalne}\label{b}
        \State\Comment{Kolejność operacji ma znaczenie.}
        \State{\textbf{return}}\Comment{Operacje zostają zastosowane w ramach warunku.}
      \EndIf
      \If{$\exists_{u, v \in V}: v \ddagger u$}
        \State{\textbf{return} $(1 + $\textsc{VC}($G \setminus \{v\}, T, k-1$)}
      \EndIf
    \EndFunction
   \end{algorithmic}
  \end{algorithm}

  Funkcje pomocnicze~\textsc{War\_Zwijanie} oraz \textsc{War\_Strukt} podejmują decyzję o zastosowaniu odpowiednio uogólnionej operacji zwijania oraz operacji strukturyzacji wobec wartości redukcji parametru $k$ możliwych do uzyskania dla aktualnej instancji problemu oraz aktualnie wybranej krotki.

  \begin{algorithm}
   \caption{Algorytm Chen, Kanj, Xia --- funkcja \textsc{War\_Zwijanie}}\label{alg_ckx_conditional_gf}
   \begin{algorithmic}[1]
    \Function{War\_Zwijanie}{}
      \If{Istnieje silna 2-krotka $(\{u, z\}, 1) \in T$}
        \If{Powtórzone zastosowanie op. \textsc{Zwijanie} redukuje $k$ do $k^\prime \leq k-2$}
          \State{Stosuj \textsc{Zwijanie} dopóki to możliwe}
        \ElsIf{Zastosowanie op. \textsc{Zwijanie} redukuje $k$ o 1 \textbf{and} $d(u) < 4$}
          \State{Stosuj \textsc{Zwijanie} dopóki to możliwe}
        \EndIf
      \Else
        \State{Stosuj \textsc{Zwijanie} dopóki to możliwe}
      \EndIf
    \EndFunction
    \algstore{xkc_break}
   \end{algorithmic}
  \end{algorithm}

  \begin{algorithm}
   \caption{Algorytm Chen, Kanj, Xia --- funkcja \textsc{War\_Strukt}}\label{alg_ckx_conditional_struction}
   \begin{algorithmic}[1]
    \Function{War\_Strukt}{}
      \If{Istnieje silna 2-krotka $\{u, v\} \in T$}
        \If{$\exists_{w \in \{u, v\}}: d(w)=3$ i $w$ poddaje się op. \textsc{Strukturyzacja}}
          \State{Zastosuj operację \textsc{Strukturyzacja} na wierzchołku $w$}
        \EndIf
      \ElsIf{$\exists_{u \in V}: 3 \leq d(u) \leq 4$ i $u$ poddaje się op. \textsc{Strukturyzacja}}
          \State{Zastosuj operację \textsc{Strukturyzacja} na wierzchołku $u$}
      \EndIf
    \EndFunction
   \end{algorithmic}
  \end{algorithm}
}
\par{
  Krotki utworzone przez algorytm podczas rozgałęziania (linie~\algref{alg_ckx}{ckx_tuple_1} --- \algref{alg_ckx}{ckx_tuple_2} algorytmu \textsc{VC}) są wykorzystywane w ramach funkcji \textsc{Redukcja} do tworzenia 2-krotek w oparciu o zasady opisywane w krokach~\algref{alg_ckx_reduction}{a2} i~\algref{alg_ckx_reduction}{a3}.
  Podczas procesu tworzenia 2-krotek, niektóre wierzchołki mogą okazać się odpowiednie do włączenia do otpymalnego pokrycia wierzchołkowego, o czym decyduje krok~\algref{alg_ckx_reduction}{a4}.
  Przykładowo, zakładając istnienie krotki $(S=\{u, w, z\}, 1)$, nałożone przez nią ograniczenie mówi, że można poszukiwać optymalnego pokrycia wierzchołkowego wykluczającego co najmniej jeden wierzchołek należący do zbioru $S$.
  W tej sytuacji jeżeli wierzchołek $v$ jest wspólnym sąsiadem wierzchołków $u$, $w$ i $z$ oznacza to, iż $v$ może zostać włączony do optymalnego pokrycia wierzchołkowego spełniającą narzuconą własność.
  Wierzchołek $v$ zostanie zatem włączony do pokrycia wierzchołkowego przez krok~\algref{alg_ckx_reduction}{a4}.

  Utrzymywanie odpowiedniego stanu kolejki priorytetowej $T$ sprowadza się do sprawdzenia czy przed rozpoczęciem kroku~\algref{alg_ckx_reduction}{b} istnieją w kolejce $T$ 2-krotki.
  Jeżeli w kolejce $T$ istnieje silna 2-krotka, zostanie ona przechowana --- w przeciwnym wypadku, jeżeli kolejka zawiera jakąkolwiek 2-krotkę, zostanie ona przechowana.
  Wszystkie pozostałe krotki zostaną usunięte z kolejki $T$.
  Przechowanie jednej 2-krotki uzasadnione jest faktem, iż 2-krotki stanowią struktury o najwyższym priorytecie, a zatem po zakończeniu działania funckji \textsc{Redukcja} algorytm \textsc{VC} wybierze tę krotkę jako pierwszą do przetworzenia.
  W konsekwencji w momencie gdy algorytm \textsc{VC} utworzy nowe krotki w momencie kolejnego rozgałęzienia, przechowana 2-krotka nie będzie już zawarta w kolejce $T$ --- a zatem nie nastąpi konflikt narzuconych przez krotki własności.
}