\section{Algorytm Chena, Kanji oraz Xia}\label{s_ckx}
\subsection{Wstęp}
\par{
  Zaprezentowane w~poprzednich rozdziałach pracy algorytmy związane są przede wszystkim z~modyfikacją struktury grafu wejściowego w~celu przyspieszenia procesu rozwiązywania problemu pokrycia wierzchołkowego.
  Każdy z~przedstawionych dotychczas algorytmów może być wykorzystywany niezależnie --- ich działanie jest ortogonalne względem siebie.
  Nie uszło to uwadze autorów pracy~\cite{ImprovedBounds10}, którzy dostrzegli potencjał optymalizacji drzemiący w~zastosowaniu starannie zaprojektowanego i~przeanalizowanego modelu redukcji dziedziny do jądra problemu.
  Model ten oparty jest na stosunkowo prostym algorytmie rekurencyjnym działającym zgodnie z~zasadą drzewa poszukiwań z ograniczeniami, popartym wyczerpującą analizą mogących zaistnieć po drodze przypadków.
  Wykorzystane w~ramach działania algorytmu funkcje redukujące dziedzinę są od siebie mocno uzależnione oraz uruchamiane w ściśle określonej kolejności w~celu zachowania poprawności logiki wysokopoziomowej i~maksymalizacji pozytywnych efektów ich wykonywania\footnote{Zawarty w~niniejszej pracy opis algorytmu Chena, Kanji oraz Xia stanowi syntezę analizy algorytmu przeprowadzonej w~różnych wersjach pracy~\cite{ImprovedBounds10}. Zaznaczyć należy, że pominięte zostały w~szczególności dowody związane z~pesymistyczną złożonością czasową algorytmu, co podyktowane jest ich obszernością. Niemniej jednak stanowią one wartościowe uzupełnienie wiedzy przy implementacji algorytmu w~oparciu o~przedstawioną analizę.}.
}
\par{
  Wedle autorów pracy~\cite{ImprovedBounds10}, główną motywacją do stworzenia niniejszego algorytmu było zwrócenie uwagi czytelnika na wartościowość gruntownej analizy dziedziny algorytmu (w przeciwieństwie do znacznie powszechniejszej analizy opartej o~charakterystyczne przypadki) w celu uzyskania jak najdokładniejszych wartości pesymistycznej złożoności obliczeniowej.
  Zastosowane podejście czerpie inspirację z niezwykle efektywnej metodyki analitycznej ,,mierz i~zwyciężaj'', zaproponowanej w~artykule~\cite{conf/icalp/FominGK05}.
  Drugim głównym celem pracy~\cite{ImprovedBounds10} jest studium najlepszej możliwej złożoności obliczeniowej osiągalnej dla rozwiązania problemu pokrycia wierzchołkowego.
  Wobec odkryć dokonanych w~pracach~\cite{Impagliazzo2001512} oraz~\cite{Cai2003789} wyjawiających, że dopóki nie zostanie udowodnione, że wszystkie problemy $\mathcal{SNP}$ (podzbiór najtrudniejszych problemów grafowych klasy $\mathcal{NP}$) są rozwiązywalne w~czasie krótszym niż wykładniczy, istnieje pewna stała $c_0 > 1$, dla której problem pokrycia wierzchołkowego nie może być rozwiązany w~czasie $c_0^kn^{O(1)}$.
  Uwaga poświęcona jest próbom jak najsilniejszego zmniejszenia stałej $c > 1$, dla której problem pokrycia wierzchołkowego rozwiązywalny jest w~czasie $c^kn^{O(1)}$.
}
\par {
  Otrzymany algorytm jest nieskomplikowany i~jednolity, zachowuje również formę poddającą się w łatwy sposób dokładnej analizie.
  Kręgosłup algorytmu stanowi utrzymywana na bieżąco kolejka priorytetowa ,,pożytecznych'' struktur służących do redukowania dziedziny problemu.
  Na każdym z~etapów algorytm wybiera strukturę o najwyższym priorytecie, zapewniającą najwięcej korzyści.
  Wybrana struktura przetwarzana jest w~sposób \emph{jednolity} oraz \emph{nieświadomy} jej kształtu.
  W wyniku analiz udało się doprowadzić do postaci algorytmu, w której istnieją jedynie dwa możliwe sposoby przetwarzania dowolnej struktury --- odzwierciedlone dwoma gałęziami algorytmu.
  Pozostałe operacje nie mają żadnych rozgałęzień --- stanowią działania pomocnicze, które ,,oczyszczają'' graf w~celu zapewnienia największej możliwej wydajności następujących po nich operacji z~rozgałęzieniami.
  Funkcja nierozgałęziających się operacji w~ramach algorytmu Chena, Kanji oraz Xia jest podobna do funkcji algorytmów przetwarzania wstępnego omówionych w~podrozdziale~\ref{Section_preprocessing}.\\
  Złożoność czasowa algorytmu wynosi $O(1.2738^k + kn)$, co stawia go w światowej czołówce najszybszych algorytmów rozwiązujących parametryzowany wariant problemu pokrycia wierzchołkowego.
}
\subsection{Podstawowe pojęcia i~obserwacje}\label{ss_ckx_preliminaries}
\par{
  W dalszym toku rozumowania przyjęte zostaną następujące oznaczenia dla grafu $G=(V, E)$:
  \begin{itemize}
    \item $|G|$ stanowi liczbę wierzchołków $|V|$ egzemplarza problemu pokrycia wierzchołkowego $(G, k)$.
    \item $\tau(G)$ stanowi rozmiar najmniejszego pokrycia wierzchołkowego grafu $G$.
  \end{itemize}
  Dla pewnego wierzchołka $v \in V$ zbiór $N[v]$ składa się z jego sąsiedztwa wraz z~nim samym, to znaczy $N(v) \cup \{v\}$.
  Dla pewnego zbioru wierzchołków $S \subseteq V$:
  \begin{itemize}
    \item $N(S)$ to suma zbiorów wierzchołków sąsiednich dla każdego wierzchołka $v_S \in S$ z wyłączeniem $v_S$, to znaczy $N(S)=\bigcup_{v_S\in S}N(v_S) \setminus S$.
    \item $N[S]$ jset zbiorem wierzchołków $N(S) \cup S$.
  \end{itemize}

  Przyjęte zostaje następujące założenie, oparte na drugim twierdzeniu Nemhausera--Trottera (Twierdzenie~\ref{nt_lp}) oraz pojęciu NT--dekompozycji, opisanej w~rozdziale~\ref{sss_kernelization_crown_context}.
  \begin{proposition}
    Istnieje algorytm o~złożoności czasowej $O(kn + k^3)$, który z~egzemplarza problemu pokrycia wierzchołkowego $(G, k)$, gdzie $|G|=n$ konstruuje inny egzemplarz $(G_1, k_1)$, dla którego własności $k_1 \leq k$, $|G_1| \leq 2k_1$ oraz $\tau(G) \leq k$ spełnione są wtedy i~tylko wtedy, gdy $\tau(G_1) \leq k_1$.
  \end{proposition}

  \begin{definition}
    Egzemplarz $(G_1, k_1)$, otrzymany przez redukcję egzemplarza $(G, k)$ z wykorzystaniem NT--dekompozycji stanowi \emph{jądro} egzemplarza $(G, k)$.
  \end{definition}
}
\par{
  Logika głównego algorytmu oparta jest na drzewie poszukiwań, zgodnie z~techniką opisywaną w podrozdziale~\ref{ss_branch_and_bound}.
  Każda iteracja podejmuje próby redukcji wartości parametru $k$ egzemplarza początkowego problemu pokrycia wierzchołkowego $(G, k)$ przez identyfikację i usunięcie z~dziedziny poszukiwań pewnego zbioru wierzchołków $S$, który w~całości przynależy do optymalnego pokrycia wierzchołkowego grafu $G$ lub też w całości jest z~niego wykluczony.
  W przypadku odnalezienia takiego zbioru algorytm usuwa należące do niego wierzchołki z~dziedziny poszukiwań i rekurencyjnie wywołuje sam siebie na zredukowanych instancjach problemu.

  Sposób redukcji egzemplarza problemu oparty jest o~następujące właściwości pokrycia wierzchołkowego grafu.
  \begin{theorem}\thlabel{th_include_neighborhood}
    Dla pewnego wierzchołka $v$ w grafie $G=(V, E)$ istnieje optymalne pokrycie wierzchołkowe $C$ zawierające zbiór $N(v)$ lub co najwyżej $|N(v)| - 2$ wierzchołków należących do zbioru $N(v)$.
  \end{theorem}
  \begin{bproof}
    Jeżeli dla pewnego wierzchołka $v$ w grafie $G=(V, E)$ pewne optymalne pokrycie wierzchołkowe $C$ zawiera $|N(v)|-1$ wierzchołków należących do zbioru $N(v)$, to musi ono zawierać również wierzchołek $v$, ponieważ krawędź $(w \in N(v) \setminus C, v)$ musi zostać pokryta.
    Przez zastąpienie w~zbiorze $C$ wierzchołka $v$ wierzchołkiem $w$ można wyznaczyć inne optymalne pokrycie wierzchołkowe $C^\prime$ zawierające zbiór $N(v)$.
  \end{bproof}
  \begin{theorem}\thlabel{th_exclude_additional_neighbor}
     W grafie $G=(V, E)$ dla pewnych wierzchołków $u \in V$ oraz $v \in V$ połączonych krawędzią $(u, v) \in E$ istnieje optymalne pokrycie wierzchołkowe $C$ zawierające wierzchołek $v$ lub wykluczające wierzchołek $v$ oraz co najmniej jeden wierzchołek sąsiadujący z~wierzchołkiem $u$.
  \end{theorem}
  \begin{bproof}
    Jeżeli każde optymalne pokrycie wierzchołkowe $C$ grafu $G$ wykluczałoby wierzchołek $v$ zawierając zarazem wszystkie wierzchołki sąsiadujące z~wierzchołkiem $u$ w grafie $G$, to pokrycie $C$ musi również zawierać wierzchołek $u$ --- krawędź $(u, v)$ musi zostać pokryta.
    Pokrycie $C^\prime=(C \setminus \{u\}) \cup \{v\}$ stanowiłoby więc zgodne z~Definicją~\ref{def_vc} optymalne pokrycie wierzchołkowe zawierające $v$ --- co przeczy założeniu, że każde optymalne pokrycie wierzchołkowe musi wykluczać wierzchołek $v$.
  \end{bproof}
  \begin{definition}
    W przypadku odnalezienia w~grafie $G$ pewnego egzemplarza problemu pokrycia wierzchołkowego $(G, k)$ zbioru $S$, który w~całości przynależy do optymalnego pokrycia wierzchołkowego $C$ lub też w całości jest z~niego wykluczony, algorytm \emph{rozgałęzia się na zbiorze $S$}.
    Oznacza to, że algorytm za każdym razem konstruuje następujące dwa zredukowane egzemplarze problemu.
    \begin{enumerate}
      \item Egzemplarz zawierający zbiór $S$ w częściowym pokryciu wierzchołkowym.
      \item Egzemplarz wykluczający zbiór $S$ z częściowego pokrycia wierzchołkowego i~zawierający wszystkie wierzchołki sąsiadujące ze zbiorem $S$ w częściowym pokryciu wierzchołkowym.
    \end{enumerate}
    Jeżeli zbiór $S$ składa się z jednego wierzchołka $v$, to mówi się, że algorytm \emph{rozgałęzia się na wierzchołku $v$}.
  \end{definition}
}
\subsubsection{\textbf{Operacja strukturyzacji}}\label{sss_ckx_struction}
\par{
  Wprowadzony w~pracy~\cite{ImprovedBounds10} wariant operacji strukturyzacji stanowi uściślenie operacji strukturyzacji opisanej w~pracy~\cite{Ebengger:1984}.
  Operacja strukturyzacji jest pierwszą z podstawowych, nierozgałęziających się funkcji pomagających w~utrzymywaniu struktury grafu w~postaci umożliwiającej maksymalizację efektywności redukcji przestrzeni poszukiwań.
  Pseudokod~\ref{alg_ckx_struction} jest przykładem odzwierciedlającym schemat działania operacji strukturyzacji.
  \begin{algorithm}
    \caption{Algorytm realizujący operację strukturyzacji}\label{alg_ckx_struction}
    \begin{algorithmic}[1]
      \Function{Strukturyzacja}{$G$, $v_0$}

        \algorithmicrequire{graf wejściowy $G=(V, E)$, wierzchołek początkowy $v_0$}

        \algorithmicensure{graf strukturyzowany $G^\prime=(V^\prime, E^\prime)$}

        \State $p \gets |N(v_0)|$
        \State $N \gets \emptyset$\Comment{Zbiór wierzchołków dodanych do zbioru $V^\prime$}
        \State $G^\prime \gets G[V \setminus N[v_0]]$
        \For{$i= 1, 2, \ldots, p$}
          \For{$j = i+1, i+2, \ldots, p$}
            \If{$(v_i, v_j) \in E$}
              \State $V^\prime \gets V^\prime \cup \{v_{ij}\}$
              \State $N \gets N \cup \{v_{ij}\}$
            \EndIf
          \EndFor
        \EndFor
        \ForAll{$v_{ir} \in N$}
          \ForAll{$v_{js} \in N$}
            \If{($i = j$ \textbf{and} $(v_r, v_s) \in E$) \textbf{or} $i \neq j$}
              \State $E^\prime \gets E^\prime \cup \{(v_{ir}, v_{js})\}$
            \EndIf
          \EndFor
          \ForAll{$u \in V \setminus N[v_0]$}
            \If{$(v_i, u) \in E$ \textbf{or} $(v_r, u) \in E$}
              \State$E^\prime \gets E^\prime \cup \{(v_{ir}, u)\}$
            \EndIf
          \EndFor
        \EndFor
        \State{\textbf{return} $G^\prime$}
      \EndFunction
    \end{algorithmic}
  \end{algorithm}
}
\par{
  \begin{definition}
    Dla pewnych dwóch wierzchołków $u$ oraz $v$ grafu $G=(V, E)$ zbiór $\{u, v\}$ stanowi \emph{antykrawędź} jeżeli $(u, v) \notin E$.
  \end{definition}

  Przyjąć należy pewien wierzchołek $v_0$ należący do grafu $G$ z sąsiedztwem $N(v_0)=\{v_1, v_2, \ldots, v_p\}$.
  Graf \emph{strukturyzowany} $G^\prime$ konstruowany jest według następujących kroków.
  \begin{enumerate}
    \item Usuń wierzchołki $v_N \in N[v_0]$ z grafu $G$ i dla każdej antykrawędzi $\{v_i, v_j\}$ w grafie $G$, gdzie $0 < i < j \leq p$, wprowadź nowy wierzchołek $v_{ij}$ do grafu strukturyzowanego $G^\prime$.
    \item Jeżeli zachodzi $i=j$, $r\neq s$ oraz $(v_r, v_s) \in E$, dodaj do grafu strukturyzowanego $G^\prime$ krawędź $(v_{ir}, v_{js})$.
    \item Jeżeli zachodzi $i \neq j$, dodaj do grafu strukturyzowanego $G^\prime$ krawędź $(v_{ir}, v_{js})$.
    \item Dla każdego wierzchołka $u \notin N[v_0]$ dodaj krawędź $(v_{ij}, u)$ jeżeli $(v_i, u) \in E$ lub $(v_j, u) \in E$.
  \end{enumerate}
  \begin{theorem}\thlabel{th_struction_feasibility}
    W grafie $G=(V, E)$ dla pewnego wierzchołka $v_0$ o sąsiedztwie $N(v_0)$, gdzie $|N(v_0)|=p$, założyć należy istnienie co najwyżej $p-1$ antykrawędzi w~zbiorze $N(v_0)$.
    Jeżeli za $G^\prime$ przyjmuje się graf otrzymany w~wyniku strukturyzacji wierzchołka $v_0$ w grafie $G$, to spełniona jest nierówność $\tau(G) \leq \tau(G^\prime) - 1$.
  \end{theorem}
  \begin{bproof}
    Przyjąć należy $\alpha(G)$ oraz $\alpha(G^\prime)$ jako oznaczenie liczebności największego zbioru niezależnego (w rozumieniu definicji~\ref{def_independent_set}) odpowiednio w~grafie $G$ oraz $G^\prime$.
    W~pracy~\cite{Ebengger:1984} udowodniono, że jest spełniona własność $\alpha(G^\prime)=\alpha(G) - 1$.
    Niech przez $n$ oraz $n^\prime$ oznaczone będą liczby wierzchołków odpowiednio grafu $G$ oraz $G^\prime$.
    Ponieważ istnieje co najwyżej $p - 1$ antykrawędzi w~zbiorze $N(v_0)$, liczba nowo utworzonych w~grafie $G^\prime$ wierzchołków może wynosić co najwyżej $p - 1$.
    Ponieważ z grafu $G$ usunięto $p+1$ wierzchołków --- to znaczy zbiór $N[v_0]$ --- łatwo zauważyć, że spełniona jest nierówność $n^\prime \leq n-2$.
    Z charakterystyki zbioru niezależnego oraz pokrycia wierzchołkowego wynika, że dla dowolnego grafu $H$ spełniona jest równość $\alpha(H)+\tau(H)=|H|$.
    Powyższe obserwacje prowadzą do wniosku, że zachowana jest następująca własność.
    \[\tau(G^\prime)=n^\prime-\alpha(G^\prime)\leq (n-2)-(\alpha(G)-1)=\tau(G)-1\]
  \end{bproof}
}
\subsubsection{\textbf{Uogólniona operacja zwijania}}\label{sss_ckx_general_fold}
\par{
  Uogólniona operacja zwijania stanowi drugą z podstawowych, niemających rozgałęzień procedur utrzymujących strukturę grafu w~postaci umożliwiającej maksymalizację efektywności działania algorytmu głównego.
  Wywodzi się ona z~techniki przetwarzania wstępnego opartej na zwijaniu połączonego sąsiedztwa wierzchołków stopnia 2.
  Metodologia postępowania tego algorytmu jest jednak podobna do techniki opisywanej w~podrozdziale~\ref{Section_preprocessing} jedynie na poziomie konceptualnym.
  Uogólnienie jej czynności pozwalające na uwolnienie się od ograniczenia stopnia zwijanego wierzchołka do 2 wymaga sięgnięcia do koncepcji NT--dekompozycji oraz koron grafu.
}
\par{
  \begin{theorem}\thlabel{th_general_fold}
    Dla grafu $G=(V,E)$ założyć należy istnienie pewnego niezależnego zbioru $I\neq \emptyset$ o zbiorze wierzchołków sąsiednich $N(I)$.
    Dodatkowo założyć należy liczebność zbioru $|N(I)|=|I| + 1$ oraz dla każdego z~podzbiorów $\emptyset \neq S \subseteq I$ liczebność sąsiedztwa $|N(S)| \geq |S| + 1$.
    Wobec takich założeń następujące stwierdzenia są prawdziwe.
    \begin{enumerate}
      \item Jeżeli graf indukowany z~grafu $G$ zbiorem $N(I)$ (w rozumieniu definicji~\ref{def_induced_graph}) nie stanowi zbioru niezależnego, to istnieje optymalne pokrycie wierzchołkowe zawierające zbiór $N(I)$ i wykluczające zbiór $I$.
      \item Jeżeli zbiór wierzchołków grafu $G[N(I)]$ jest zbiorem niezależnym, należy przyjąć graf $G^\prime=(V^\prime, E^\prime)$ uzyskany z~grafu $G$ tak, że $V^\prime=V \setminus (I \cup N(I)) \cup \{u_I\}$ gdzie $u_I$ stanowi nowo dodany wierzchołek, który należy połączyć z każdym wierzchołkiem $v \in V^\prime$ sąsiadującym w~grafie $G$ z dowolnym wierzchołkiem $u \in N(I)$.
      W przypadku spełnienia tych założeń spełniona jest równość $\tau(G^\prime)=\tau(G)-|I|$.
    \end{enumerate}
  \end{theorem}
  \begin{bproof} W celu udowodnienia poprawności operacji należy wpierw ugruntować fundamenty teoretyczne łączące strukturę $(I, N(I))$ z pokryciem wierzchołkowym --- poświęcona temu jest część (0) dowodu.
    Następujące części kolejno dowodzą przypadków opisanych twierdzeniem~\ref{th_general_fold}.
    \begin{itemize}
      \item[(0):] Dla grafu $G=(V, E)$ istnieje optymalne pokrycie wierzchołkowe $C$ zawierające zbiór $N(I)$ oraz wykluczające zbiór $I$.
      Przyjąć należy zbiory $\emptyset \neq X=C \cap I$ oraz $\emptyset \neq Y=C \cap N(I)$.
      Ponieważ zbiór $C$ stanowi pokrycie wierzchołkowe grafu $G$, jeżeli $X=\emptyset$, to wtedy $Y=N(I)$ --- podobnie jak i~w sytuacji, gdyby $Y=\emptyset$, wtedy $X=I$.
      Pozwala to przyjąć założenie, że żaden ze zbiorów $X$, $Y$ nie może być pusty.
      Ponownie z~założenia, że zbiór $C$ stanowi pokrycie wierzchołkowe grafu $G$ wynika, że zachodzi $N(I-X)\subseteq Y$.
      W sytuacji gdy $I \supset X$, z założenia twierdzenia dotyczącego rozmiarów zbioru sąsiedztwa $N(I)$ wynika, że prawdziwa jest nierówność $|Y| \geq |N(I \setminus X)| \geq |I \setminus X| + 1 = |I| - |X| + 1$.
      W sytuacji gdy $I = X$, to ponieważ $Y \neq \emptyset$, tak jak w~poprzednim przypadku spełniona jest nierówność $|Y|\geq|I|-|X|+1$.
      Ponieważ zbiór $I$ jest niezależny w~grafie $G$, zastąpienie zbioru $Y \cup X$ zbiorem $N(I)$ w pokryciu wierzchołkowym $C$ owocuje pokryciem wierzchołkowym $C^\prime$ grafu $G$ o liczebności $|C^\prime| \leq |C|$.
      Wobec tego toku rozumowania łatwo zauważyć, że zbiór $C^\prime$ stanowi pokrycie wierzchołkowe grafu $G$ o najmniejszej liczebności, które zawiera zbiór $N(I)$ oraz wyklucza zbiór niezależny $I$.
      \item[(1):] Założyć należy istnienie pokrycia wierzchołkowego $C$ spełniającego założenia części (0) dowodu.
      Jeżeli zbiór wierzchołków grafu $G[N(I)]$ nie jest zbiorem niezależnym, to każde z~istniejących pokryć wierzchołkowych grafu $G$, a~w~szczególności zbiór $C$, musi zawierać zbiór $N(I)$.
      Prowadzi to do wniosku, że zbiór $C$ stanowi optymalne pokrycie wierzchołkowe grafu $G$ zawierające zbiór $N(I)$ i wykluczające zbiór niezależny $I$.
      \item[(2):] Jeżeli zbiór $N(I)$ stanowić miałby zbiór niezależny w~grafie $G$, to w~sytuacji, gdy zachodzi $C \supseteq I$, zbiór $C$ musiałby jednocześnie wykluczać zbiór $N(I)$ oraz zawierać zbiór $N(N(I))$ w grafie $G^\prime$.
      W takim przypadku zbiór $C^\prime=C \setminus I$ stanowi pokrycie wierzchołkowe grafu $G^\prime$ o liczebności $|C|-|I|=\tau(G)-|I|$ oraz spełniona jest nierówność $\tau(G^\prime)\leq\tau(G)-|I|$ --- właściwość ta oznaczona zostanie jako \textit{(2.1)}.

      W sytuacji gdzie zachodzi $C \supseteq N(I)$, zbiór $C^\prime=(C \setminus N(I))\cup \{u_I\}$ stanowi pokrycie wierzchołkowe grafu $G^\prime$ o liczebności $\tau(G)-(|I|+1)+1=\tau(G)-|I|$ oraz ponownie spełniona jest nierówność $\tau(G^\prime)\leq\tau(G)-|I|$ --- właściwość ta oznaczona zostanie jako \textit{(2.2)}.

      Jeżeli zbiór $C^\prime$ stanowi optymalne pokrycie wierzchołkowe grafu $G^\prime$, to musi on albo zawierać wierzchołek $u_I$ albo wykluczać wierzchołek $u_I$ i zawierać zbiór jego sąsiedztwa $N(u_I)$.
      Jeżeli zbiór $C^\prime$ zawiera wierzchołek $u_I$, to wtedy zbiór $(C^\prime - \{u_I\}) \cup N(I)$ stanowi pokrycie wierzchołkowe grafu $G$ o liczebności $|C^\prime|+|I|$, co powoduje spełnienie nierówności $\tau(G^\prime)\geq \tau(G)-|I|$ --- właściwość ta oznaczona zostanie jako \textit{(2.3)}.

      Jeżeli zbiór $C^\prime$ wyklucza wierzchołek $u_I$, zawierając jednocześnie zbiór jego sąsiedztwa $N(u_I)$, to wtedy zbiór $C^\prime$ ponownie stanowi pokrycie wierzchołkowe grafu $G$ o liczebności $|C^\prime|+|I|$ i ponownie spełniona jest nierówność $\tau(G^\prime)\geq \tau(G)-|I|$ --- właściwość ta oznaczona zostanie jako \textit{(2.4)}.

      Powyższy tok rozumowania dowodzi, że w~sytuacji (2) zawsze zachodzić będzie po jednej własności z~par (\textit{(2.1)}, \textit{(2.2)}) oraz (\textit{(2.3)}, \textit{(2.4)}).
      Bez względu na konfigurację spełnionych własności, w sytuacji (2) niezmiennie spełniona jest równość $\tau(G^\prime)=\tau(G)-|I|$.
    \end{itemize}
  \end{bproof}

  \begin{definition}
    Uporządkowana para $(I, H=(N(I)))$ opisywana twierdzeniem~\ref{th_general_fold} stanowi~\emph{pseudokoronę} w grafie $G$.
  \end{definition}

  Struktura pseudokorony nie jest koroną, ponieważ nie spełnia określonych w~Definicji~\ref{def_crown} założeń dotyczących rozmiaru zbiorów składowych, to znaczy nierówności $|H| \leq |I|$.
  W związku z~tym graf wolny od koron może zawierać pseudokoronę --- obserwacja ta stanowi klucz do uogólnienia logiki procedury zwijania.
  Pseudokod~\ref{alg_ckx_gf} jest przykładem odzwierciedlającym schemat działania uogólnionej operacji zwijania.
  \begin{algorithm}
    \caption{Algorytm realizujący uogólnioną operację zwijania}\label{alg_ckx_gf}
    \begin{algorithmic}[1]
      \Function{Zwijanie}{$G$, $k$}

        \algorithmicrequire{graf wejściowy $G=(V, E)$, maksymalny rozmiar pokrycia wierzchołkowego $k$}

        \algorithmicensure{graf wynikowy $G^\prime=(V^\prime, E^\prime)$, zmniejszona wartość parametru $k^\prime \leq k$}
        \State $G^\prime \gets G$
        \State $k^\prime \gets k$
        \State $c=(I, H) \gets \Call{WyznaczKorone}{G^\prime, k}$\Comment{Zgodnie z~pseudokodem~\ref{alg_findCrown}}
        \While{korona $c$ nie jest trywialna}
          \State $G^\prime = G^\prime[V^\prime \setminus I \setminus H]$
          \State $k^\prime \gets k^\prime - |H|$
        \EndWhile
        \ForAll{$v \in V^\prime$}
          \State $G^\prime \gets G^\prime[V^\prime \setminus \{v\}]$
          \State $p=(I, H) \gets \Call{WyznaczKorone}{G^\prime, k}$\Comment{Zgodnie z~pseudokodem~\ref{alg_findCrown}}
          \If{pseudokorona $p$ nie jest trywialna}
            \State $G^\prime = G^\prime[V^\prime \setminus I \setminus H]$
            \State $k^\prime \gets k^\prime - |I|$
            \State{\textbf{return} $G^\prime$, $k^\prime$}
          \EndIf
          \State $G^\prime \gets G^\prime[V^\prime \cup \{v\}]$
        \EndFor
        \State{\textbf{return} $G^\prime$, $k^\prime$}
      \EndFunction
    \end{algorithmic}
  \end{algorithm}
}

\par{
  Opis procesu poszukiwań pseudokoron w~grafie posługuje się skrótem myślowym dotyczącym skojarzenia składowego zbioru niezależnego z~głową odnalezionej pseudokorony. 
  Poprawność tego uproszczenia ugruntowana jest w~twierdzeniu Halla\footnote{Dowód twierdzenia Halla jest poza zakresem niniejszej pracy --- twierdzenie to jest jednak fundamentalnym elementem wielu prac naukowych oraz kursów uczelnianych związanych z~grafami co sprawia, że nietrudno teniż dowód odnaleźć w ogólnodostępnej literaturze.}.
  Zastosowane w~przytoczonej treści twierdzenia Halla oznaczenia są spójne z~konwencjami wprowadzonymi na początku podrozdziału~\ref{s_ckx}.
  \begin{theorem}[Twierdzenie Halla]\thlabel{th_hall}
    Dla dwudzielnego grafu $G$ o podziale $(A, B)$ skojarzenie pokrywające całość zbioru $A$ może istnieć wtedy i~tylko wtedy, gdy każdy podzbiór $X \subseteq A$ spełnia własność $|N(X)| \geq |X|$.
  \end{theorem}
  Kluczowym krokiem dla odnalezienia struktury pseudokorony w~niemającym koron grafie $G$ jest istnienie pewnego wierzchołka $v$, który stanowi jedyny wierzchołek czyniący strukturę grafu $G$ wolną od koron, czego analiza przeprowadzona zostaje w~ramach dowodu następującego twierdzenia.
  \begin{theorem}\thlabel{th_almost_crown}
    Wolny od koron graf $G=(V, E)$ zawiera pseudokoronę wtedy i~tylko wtedy, gdy istnieje wierzchołek $v \in V$ taki, że graf $G[V\setminus \{v\}]$ zawiera równą koronę (w rozumieniu definicji~\ref{def_equal_crown}).
  \end{theorem}
  \begin{bproof}
    Zakładając, że graf $G$ ma pseudokoronę $(I, H=N(I))$, spełnione muszą być własności $|H| = |I| + 1$ oraz $\forall_{\emptyset\neq S \subseteq I}:{|N(S)|\geq|S|+1}$.
    Przyjąć za dane należy dowolny wierzchołek $v \in H$ oraz zbiór $H^\prime=H \setminus \{v\}$ --- wtedy spełniona jest równość $|H^\prime|=|I|$.
    Łatwo zauważyć, że w~tym przypadku para $(I, H^\prime)$ stanowi równą koronę w grafie $G^\prime = G[V \setminus \{v\}]$.
    W grafie $G^\prime$ musi zachodzić równość $H^\prime = N(I)$.
    W związku z~tym, że graf $G$ nie zawiera żadnej korony, dla każdego niepustego podzbioru $S \subseteq I$ spełniona w~grafie $G$ jest nierówność $|N(S)| \geq |S|+1$, co z~kolei implikuje, że dla każdego ze zbiorów $S$ w grafie $G^\prime$ zachodzi nierówność $|N(S)| \geq |S|$.
    Twierdzenie~\ref{th_hall} pozwala stwierdzić, że zbiór $I$ kojarzy zbiór $H^\prime$ a~zatem, na mocy równości $|H^\prime|=|I|$, zbiór $H^\prime$ musi w~ten sam sposób kojarzyć zbiór $I$, co dopełnia definicji równej korony i~dowodzi, że graf $G^\prime$ musi taką koronę zawierać.

    Spoglądając z~innej perspektywy --- utrzymując założenie, że graf $G$ nie zawiera koron i~istnieje taki wierzchołek $v \in V$, że graf $G^\prime= G[V \setminus \{v\}]$ zawiera równą koronę $(I, H^\prime)$ postuluje się, że struktura $(I, H=H^\prime \cup \{v\})$ stanowi pseudokoronę w grafie $G$.
    Wierzchołek $v$ musi należeć do zbioru $N(I)$ w grafie $G$ --- w przeciwnym razie w~grafie $G$ spełniona musiałaby być równość $H^\prime=N(I)$, w wyniku czego struktura $(I, H^\prime)$ musiałaby stanowić koronę w grafie $G$, co przeczy założeniu o~braku koron w~grafie $G$.
    Zatem w~grafie $G$ spełnione są własności $H=N(I)$ oraz $|H|=|I|+1$.
    Zakładając istnienie niepustego podzbioru $S \subseteq I$ oraz pamiętając, że struktura $(I, H^\prime)$ stanowi równą koronę w grafie $G^\prime$ i zbiór $I$ jest w~pełni skojarzony ze zbiorem $H^\prime$ widać, że $|N(S)| \geq |S|$ w grafie $G^\prime$.
    W tej sytuacji, w przypadku gdy wierzchołek $v$ sąsiaduje w~grafie $G$ ze zbiorem $N(S)$, spełniona jest nierówność $|N(S)| \geq |S| + 1$.
    W przeciwnym razie, to znaczy gdy zachodzi $v \notin N(S)$, zbiór $N(S)$ jest identyczny zarówno w~grafie $G$ jak i $G^\prime$.
    Jeżeli zatem spełnione jest równanie $|N(S)|=|S|$, to w~związku z~tym, że zbiór $S$ jest skojarzony ze zbiorem $N(S)$, musiałoby to oznaczać, że zbiór $N(S)$ jest skojarzony ze zbiorem $S$.
    W konsekwencji struktura $(S, N(S))$ musiałaby stanowić koronę w grafie $G$, co przeczy założeniu, że nie ma on żadnej korony.
    Wobec tej sprzeczności, jeżeli wierzchołek $v$ nie sąsiaduje ze zbiorem $S$ w grafie $G$, to spełniona musi być właściwość $|N(S)| \geq |S| + 1$.

    W efekcie, bez względu na to czy wierzchołek $v$ sąsiaduje ze zbiorem $S$ czy nie, nierówność $|N(S)| \geq |S| + 1$ jest spełniona dla każdego niepustego podzbioru $S \subseteq I$ --- co zaświadcza, że struktura $(I, H=N(I))$ stanowi pseudokoronę w grafie G.
  \end{bproof}

  Jak wspomniano wcześniej, uogólniona operacja zwijania posługuje się strukturami realizującymi koncepcje NT--dekompozycji i~koron.
  Celem operacji jest jak największa redukcja dziedziny problemu, możliwa w~danym momencie realizacji aktualnej gałęzi algorytmu głównego.
  Algorytm realizujący uogólnioną operację zwijania musi zatem pozbyć się z aktualnej postaci grafu wszystkich struktur koron i~pseudokoron.

  \begin{theorem}
    Istnieje algorytm $\mathcal{A}$ o złożoności $O(k^3\sqrt{k})$ redukujący dowolny egzemplarz $(G=(V, E), k)$ problemu pokrycia wierzchołkowego o~rozmiarze $|V|\leq 2k$ do niemającego koron ani pseudokoron egzemplarza $(G^\prime=(V^\prime, E^\prime), k^\prime)$ o parametrach $|V^\prime| \leq |V|$ oraz $k^\prime \leq k$.
  \end{theorem}
  \begin{bproof}
    W celu usunięcia koron z~grafu $G$ należy wyznaczać kolejne NT--dekompozycje i~redukować za ich pomocą dziedzinę poszukiwań pokrycia wierzchołkowego do momentu otrzymania trywialnego egzemplarza korony (w rozumieniu definicji~\ref{def_trivial_crown}).
    Zgodnie z~drugim twierdzeniem Nemhausera--Trottera~(Twierdzenie~\ref{nt_lp}) każde zastosowanie NT--redukcji wymaga $O(|V|\sqrt{|E|})$ czasu.
    Rozmiary grafu w~rozpatrywanym egzemplarzu problemu pokrycia wierzchołkowego wynoszą odpowiednio $|V|=O(k)$ oraz $|E|=O(k^2)$ --- zatem łatwo zauważyć, że każda NT--redukcja zajmie tak naprawdę $O(k^2\sqrt{k})$ czasu.
    Każda NT--dekompozycja redukuje dziedzinę grafu, a~zatem do momentu uzyskania trywialnego egzemplarza korony operacja zostanie wykonana $O(k)$ razy.
    Po otrzymaniu trywialnego egzemplarza korony założyć można, że zredukowany graf nie ma żadnych koron, zgodnie z~Twierdzeniem~\ref{th_crown_free_graph}.
    Łatwo zaobserwować, że w~czasie $O(k^3\sqrt(k))$ można zredukować egzemplarz $(G, k)$ problemu pokrycia wierzchołkowego do egzemplarza $(G^\prime, k^\prime)$, gdzie graf $G^\prime$ nie zawiera żadnych koron.
    Każda aplikacja NT--redukcji owocująca nietrywialnym egzemplarzem NT--dekompozycji powoduje zmniejszenie parametru $k$ o wartość odpowiadającą szerokości korony (w rozumieniu definicji~\ref{def_crown_head}) zawartej w~danym egzemplarzu.

    Podążając za dowodem twierdzenia~\ref{th_almost_crown}, struktura pseudokorony może istnieć w grafie $G^\prime$ wtedy i~tylko wtedy, kiedy zawiera on taki wierzchołek $v$, że graf $G^\prime[V \setminus \{v\}]$ zawiera równą koronę.
    Proces wyznaczania pseudokorony polega zatem na przeprowadzeniu NT--redukcji na grafie $G^\prime[V \setminus \{v\}]$ dla każdego wierzchołka $v \in G^\prime$.
    Jeżeli dowolna z~przeprowadzonych NT--redukcji owocuje egzemplarzem korony, to na mocy twierdzenia~\ref{th_almost_crown} musi to być równa korona --- w przeciwnym razie graf $G^\prime$ musiałby zawierać koronę.
    W efekcie odkryta zostaje struktura pseudokorony, to znaczy wierzchołka $v_c$ wraz z~koroną otrzymaną z NT--dekompozycji grafu $G^\prime[V \setminus \{v_c\}]$.
    Operacja wyznaczania pseudokorony zajmuje $O(k^{\prime3}\sqrt{k^\prime})=O(k^3\sqrt{k})$ czasu, ponieważ należy przeprowadzić co najwyżej $O(k)$ NT--redukcji dla indukowanych grafów.

    Po wykonaniu powyższych operacji otrzymany graf jest wolny od koron, nie zawiera też pseudokoron.
    Z twierdzenia~\ref{th_crown_domain_reduction} wynika, że rozmiar wynikowego egzemplarza problemu wynosi $|V^\prime| \leq 2k^\prime$.
  \end{bproof}
}
\subsubsection{\textbf{Struktury ,,pożyteczne''}}
\label{sss_ckx_structures}
\par{
  Identyfikacja struktur ,,pożytecznych'' (zwanych również po prostu \emph{strukturami}) w grafie związanym z~rozpatrywanym egzemplarzem problemu pokrycia wierzchołkowego pozwala na maksymalizację efektywności procesu redukcji dziedziny do jądra problemu, co przekłada się na zmniejszenie złożoności czasowej algorytmu. Klasy struktur wraz z~odpowiadającymi im priorytetami zostały wyznaczone w~pracy~\cite{ImprovedBounds10} drogą analityczną --- przez identyfikację i dekonstrukcję mogących wystąpić w ogólnych grafach przypadków mających znaczenie dla parametryzowanego wariantu problemu pokrycia wierzchołkowego.
  Wartość ,,pożyteczności'' danej klasy struktur określana jest przede wszystkim na podstawie relacji pomiędzy składającymi się na nie wierzchołkami.
}
\par{
  Bardzo intensywnie wykorzystywanymi w~identyfikacji struktur pojęciami są zachodzące pomiędzy wierzchołkami relacje \emph{dominacji} oraz \emph{pseudodominacji}.
  \begin{definition}\thlabel{def_domination}
    W grafie $G=(V, E)$ pewien wierzchołek $u$ jest \emph{zdominowany} przez pewien wierzchołek $v$ (wierzchołek $v$ \emph{dominuje} nad wierzchołkiem $u$) jeżeli są one połączone krawędzią $(u, v) \in E$ oraz jest spełniona własność $N(u) \subseteq N[v]$.
    W celu uproszczenia zapisów, dla wyrażenia dominacji wierzchołka $v$ nad wierzchołkiem $u$ stosowana będzie notacja $v \ddagger u$.
  \end{definition}
  \begin{definition}\thlabel{def_almost_domination}
    W grafie $G=(V, E)$ pewien wierzchołek $u$ jest \emph{pseudozdominowany} przez pewien wierzchołek $v$ (wierzchołek $v$ \emph{pseudodominuje} nad wierzchołkeiem $u$) jeżeli nie są one połączone krawędzią $(u, v) \notin E$ oraz jest spełniona własność $|N(u) \setminus N(v)| \leq 1$.
    W celu uproszczenia zapisów, dla wyrażenia pseudodominacji wierzchołka $v$ nad wierzchołkiem $u$ stosowana będzie notacja $v \dagger u$.
  \end{definition}
  \begin{theorem}
      Jeżeli w~grafie $G=(V, E)$ pewien wierzchołek $v$ dominuje nad pewnym wierzchołkiem $u$, to istnieje optymalne pokrycie wierzchołkowe grafu $G$ zawierające wierzchołek $v$.
  \end{theorem}
  \begin{bproof}
    Jeżeli pewne optymalne pokrycie wierzchołkowe $C$ nie zawiera wierzchołka $v$, to musi zawierać zbiór jego wierzchołków sąsiednich $N(v)$, który zawiera wierzchołek $u$ (w oparciu o~Definicję~\ref{def_domination}).
    W związku z~tym, że zbiór $(N(u) \setminus \{v\})$ jest zawarty w~zbiorze $N(v)$, zastąpienie wierzchołka $u$ przez $v$ w zbiorze $C$ owocuje optymalnym pokryciem wierzchołkowym zawierającym wierzchołek $v$.
  \end{bproof}
}
\par{
  Szczególną klasą struktur są tak zwane \emph{dobre pary}.
  Głównym zastosowaniem dobrych par jest maksymalizacja efektywności redukcji dziedziny uzyskiwanej w~momencie rozgałęziania się głównego algorytmu.
  \begin{definition}
    W grafie $G=(V, E)$ \emph{dobrą parę} stanowi para wierzchołków $\{u, z\}$ wybranych wedle następujących kryteriów.
    Dla każdego wierzchołka $u \in V$ mającego zbiór wierzchołków sąsiednich $N(u)=\{u_1, u_2, \ldots, u_d\}$ zdefiniować należy jego \emph{etykietę} jako wektor $\eta=<\eta_1, \eta_2, \ldots, \eta_d>$, gdzie $\eta_1$ stanowi stopień wierzchołka sąsiadującego z~wierzchołkiem $u$ o największym stopniu $u_{a} \in N(u), d(u_{a})=\max\{d(u_n) | u_n \in N(u)\}$, $\eta_2$ jest stopniem wierzchołka sąsiadującego z~wierzchołkiem $u$ o drugim w~kolejności największym stopniu $u_{b} \in N(u), d(u_{b})=\max\{d(u_n) | u_n \in N(u) \setminus \{u_{a}\}\}$ itd. --- $\eta_d$ stanowi stopień wierzchołka sąsiadującego z~wierzchołkiem $u$ o najniższym stopniu spośród wszystkich wierzchołków zbioru $N(u)$ --- $u_{z} \in N(u), d(u_{z})=\min\{d(u_n) | u_n \in N(u)\}$.

    W celu określenia pierwszego wierzchołka pewnej dobrej pary należy wybrać wierzchołek $u \in V$ spełniający następujące własności w~podanym porządku.
    \begin{enumerate}[(i)]
      \item Wektor etykiety wierzchołka $u$ jest największy w~porządku leksykograficznym spośrów wektorów etykiet wszystkich wierzchołków $w \in G$ stopnia $d(w)=d(u)$.
      \item  Jeżeli graf $G$ jest regularny (w rozumieniu definicji~\ref{def_regular}), to liczba par wierzchołków $\{x, y\} \subseteq N(u)$, w których wierzchołek $y$ jest pseudozdominowany przez wierzchołek $x$ jest największa z~możliwych.
      \item Liczba krawędzi pomiędzu wierzchołkami $v_u \in N(u)$ jest największa z~możliwych.
    \end{enumerate}

    W celu identyfikacji drugiego wierzchołka pewnej dobrej pary należy wybrać wierzchołek $z \in N(u)$ spełniający następujące własności w~podanym porządku.
    \begin{enumerate}[(a)]
      \item Jeżeli istnieją pewne dwa wierzchołki $v,w \in N(u)$, z których wierzchołek $v$ jest pseudozdominowany przez wierzchołek $w$, to wierzchołek $z$ jest pseudozdominowany przez pewien wierzchołek $x \in N(u)$.
      \item Stopień wierzchołka $d(z)$ jest największy z~możliwych wśród wierzchołków sąsiadujących z~wierzchołkiem $u$, spełniających własność (a).
      W sytuacji, gdy żaden wierzchołek $v \in N(u)$ nie pseudodominuje żadnego innego wierzchołka $w \in N(u)$, własność (a) jest spełniona w~sposób przechodni przez każdy wierzchołek sąsiadujący z~wierzchołkiem $u$ --- wierzchołek $z$ będzie wtedy po prostu sąsiadem największego stopnia wierzchołka $u$.
      \item Wierzchołek $z$ jest połączony krawędzią z jak najmniejszą liczbą wierzchołków należących do sąsiedztwa wierzchołka $u$ spośród wszystkich wierzchołków, dla których zachodzą własności (a) i (b).
      \item Liczba wierzchołków sąsiednich współdzielonych przez wierzchołek $z$ oraz inny wierzchołek nalężący do sąsiedztwa wierzchołka $u$ jest największa z~możliwych spośród wszystkich elementów zbioru $N(u)$, dla których zachodzą własności (a), (b) i (c).
    \end{enumerate}
  \end{definition}
}
\subsubsection{\textbf{Krotki}}
\label{sss_ckx_tuples}
\par{
  Szczególnie ważną klasę identyfikowanych w~grafie struktur z~punktu widzenia redukcji przestrzeni poszukiwań stanowią \emph{krotki}.
  \begin{definition}
    \emph{Krotka} stanowi uporządkowaną parę $(S, q)$, gdzie $S$ to zbiór wierzchołków, a~wartość $q$ jest liczbą całkowitą.
    Krotka niesie ze sobą informację, że w~aktualnie rozpatrywanym egzemplarzu problemu pokrycia wierzchołkowego $(G, k)$ można wyznaczyć optymalne pokrycie wierzchołkowe z~wyłączeniem co najmniej $q$ wierzchołków należących do zbioru $S$.
  \end{definition}
  W praktyce algorytm rozpatruje wyłącznie krotki $(S, q)$ dla wartości $q \leq 2$ --- wyłącznie na nich skupiona jest również analiza.
  Najbardziej wartościowym podzbiorem krotek są tak zwane \emph{2-krotki} oraz \emph{silne 2-krotki}.
  \begin{definition}
    Krotka $(S, q)$ jest \emph{2-krotką} jeżeli zbiór $S$ ma postać $S=\{u, v\}$ oraz spełnione są następujące warunki.
    \begin{enumerate}
      \item $q=1$.
      \item $d(u) \geq d(v)$.
      \item $(u, v) \notin E$.
    \end{enumerate}
  \end{definition}
  \begin{definition}
    2-krotka $(S, q)$ jest \emph{silną 2-krotką} jeżeli spełnia jeden z~następujących warunków.
    \begin{enumerate}
      \item $d(u) \geq 4 \land d(v) \geq 4$.
      \item $2 \leq d(u) \leq 3 \land 2 \leq d(v) \leq 3$.
    \end{enumerate}
  \end{definition}
}
\par{
  Aby uwidocznić wysoką wartość krotek, należy wyjaśnić w jaki sposób algorytm wykorzystuje te struktury podczas rozgałęziania.
  Dla potrzeb wyjaśnienia przyjąć należy, że algorytm rozgałęzia się na pewnym wierzchołku $z$ o sąsiedztwie $N(z)$.
  Na podstawie obserwacji dokonanej w~ramach twierdzenia~\ref{th_include_neighborhood} stwierdzić można, że istnieje optymalne pokrycie wierzchołkowe grafu $G$ zawierające zbiór $N(z)$ lub wykluczające co najmniej dwa wierzchołki należące do tego zbioru.
  Wobec tego w~momencie rozgałęziania algorytmu, w egzemplarzu zawierającym wierzchołek $z$ przestrzeń poszukiwań może zostać ograniczona do pokrycia wierzchołkowego zbioru wykluczającego co najmniej dwa wierzchołki należące do sąsiedztwa wierzchołka $z$ --- operacja ta jest poprawna, ponieważ jeżeli takie pokrycie nie istnieje, to gałąź rozpatrująca egzemplarz zawierający całość zbioru $N(z)$ odnajdzie optymalne pokrycie wierzchołkowe (jeżeli takowe istnieje).
  Pojęcie wykluczenia co najmniej dwóch wierzchołków sąsiadujących z~wierzchołkiem $z$ jest materializowane przez stworzenie w~momencie rozgałęziania krotki $(N(z), q=2)$.

  W sytuacji, gdy algorytm rozgałęzia się na pewnym wierzchołku $z$ mającym pewien sąsiedni wierzchołek $u$, zgodnie z~obserwacją dokonaną w ramach twierdzenia~\ref{th_exclude_additional_neighbor} musi istnieć optymalne pokrycie wierzchołkowe, które albo zawiera wierzchołek $z$ albo wyklucza wierzchołek $z$ oraz co najmniej jeden wierzchołek należący do sąsiedztwa wierzhołka $u$.
  Przestrzeń poszukiwań w ramach tej gałęzi algorytmu może być zatem ograniczona do zbioru wykluczającego co najmniej dwa wierzchołki należące do zbioru $N(u)$.
  Pojęcie wykluczenia tychże wierzchołków materializowane jest przez utworzenie w~momencie rozgałęziania krotki $(N(u), q=2)$.
}
\subsubsection{\textbf{Aktualizacja krotek}}
\label{sss_ckx_updating_tuples}
\par{
  Krotki odzwierciedlają szczególne własności zachodzące w~strukturze grafu w~momencie pewnego rozgałęzienia algorytmu, są jednak utrzymymwane w~kolejce priorytetowej struktur przez okres czasu mogący obejmować więcej niż jedno rozgałęzienie.
  W związku z~tym, że krotka narzuca pewne ograniczenia na postać poszukiwaneg optymalnego pokrycia wierzchołkowego, należy dbać o to by stan krotek odzwierciedlał wszelkie zmiany zachodzące w~strukturze grafu w~związku z~działaniami wykonywanymi na innych strukturach, które mają wpływ na wierzchołki zawarte w~tychże krotkach.
}
\par{
  Przyjmując istnienie pewnej krotki $(S, q)$, jeżeli wartość $q = 0$, to krotkę tę należy usunąć z kolejki priorytetowej, ponieważ reprezentowana przez nią własność spełniona jest przez dowolne pokrycie wierzchołkowe.
  \begin{theorem}
    Jeżeli pewien wierzchołek $v \in S$ zostanie usunięty z~dziedziny poszukiwań przez wykluczenie go z~pokrycia wierzchołkowego, to krotka $(S, q)$ musi zostać uaktualniona przez usunięcie wierzchołka $v$ ze zbioru $S$ oraz dekrementację wartości $q$.
  \end{theorem}
  \begin{bproof}
    Jeżeli istnieje optymalne pokrycie wierzchołkwe $C$, które wyklucza co najmniej $q$ wierzchołków należących do zbioru $S$, to wtedy pokrycie $C$ musi wykluczać co najmniej $q-1$ wierzchołków ze zbioru $S \setminus \{v\}$.
  \end{bproof}
  \begin{theorem}
    Jeżeli pewien wierzchołek $v \in S$ zostanie usunięty z~dziedziny poszukiwań przez włączenie go do pokrycia wierzchołkowego, to krotka $(S, q)$ musi zostać uaktualniona przez usunięcie wierzchołka $v$ ze zbioru $S$, a~wartość $q$ nie ulega zmianie.
  \end{theorem}
  \begin{bproof}
    Jeżeli istnieje optymalne pokrycie wierzchołkowe $C$ zawierające wierzchołek $u$ oraz wykluczające co najmniej $q$ wierzchołków ze zbioru $S$, to musi ono wykluczać co najmniej $q$ wierzchołków ze zbioru $S \setminus \{v\}$.
  \end{bproof}
}
\par{
  Bardziej radykalne działania wymagane są w przypadku wykonania operacji wprowadzających ograniczenia struktury grafu wchodzące konflikt z~ograniczeniami przedstawianymi przez istniejące krotki.
  Operacje, w wyniku których powstają ograniczenia wchodzące w~konflikt z~ograniczeniami przedstawianymi przez istniejące krotki związanymi z~postacią poszukiwanego optymalnego pokrycia wierzchołkowego to tworzenie nowych krotek, operacja strukturyzacji oraz uogólniona operacja zwijania.
  Przykładowo, uogólniona operacja zwijania zakłada, że poszukiwane jest optymalne pokrycie wierzchołkowe zawierające niezależny zbiór $I$ lub jego sąsiedztwo dla odnalezionej struktury $(I, H=N(I))$ --- stanowi to podstawową własność umożliwiającą zwinięcie zbioru $N(I)$.
  Zwinięcie dowolnego takiego zbioru może pozostawić wynikową strukturę grafu w~konflikcie z~ograniczeniami narzucanymi przez niektóre istniejące już krotki.
  W związku z~bardzo dużą liczbą potencjalnych sytuacji, w których tego typu konflikt może następować, algorytm zaprojektowany w~pracy~\cite{ImprovedBounds10} zakłada, że po każdym zastosowaniu operacji strukturyzacji lub uogólnionej operacji zwijania wszystkie istniejące krotki zostaną usunięte z~kolejki priorytetowej.

  W celu weryfikacji możliwości zastosowania operacji strukturyzacji lub uogólnionej operacji zwijania należy sprawdzić czy redukcja parametru $k$ wynikająca z~ich zastosowania będzie większa niż redukcja otrzymana z~rozgałęzienia algorytmu na aktualnie rozpatrywanej krotce.
  W tym celu wprowadzone zostały dwie dodatkowe procedury weryfikujące te własności i~na tej podstawie warunkowo dokonujące aplikacji wyżej wymienionych operacji.
}
\subsection{Algorytm główny}
\label{ss_ckx_vc}
\par{
  Algorytm rozwiązujacy parametryzowany wariant problemu pokrycia wierzchołkowego przedstawiony w~pracy~\cite{ImprovedBounds10} działa zgodnie z~pseudokodem~\ref{alg_ckx}.
   \begin{algorithm}
    \caption{Algorytm rozwiązujący problem pokrycia wierzchołkowego według Chena, Kanji oraz Xia}\label{alg_ckx}
    \begin{algorithmic}[1]
      \Function{VC}{$G$, $T$, $k$}

        \algorithmicrequire{Graf wejściowy $G=(V, E)$, kolejka priorytetowa $T$ struktur, parametr ograniczający $k$}

        \algorithmicensure{Liczebność ($\leq k$) optymalnego pokrycia wierzchołkowego grafu $G$ jeżeli takowe istnieje lub zgłoszenie porażki}

        \If{$k \leq 7$}
        \State{Rozwiąż egzemplarz metodą siłową i zakończ działanie}
        \EndIf
        \State$\Call{Redukcja}$
        \State{Wybierz strukturę $\Gamma$ o najwyższym priorytecie z~kolejki $T$}
        \If {$(\Gamma$ jest 2-krotką $(\{u, z\}, 1))$ \textbf{ or }\\
             \hspace{2.6em}($\Gamma$ jest dobrą parą $(u, z)$ gdzie $z\dagger v\in N(u))$ \textbf{or}\\
             \hspace{2.6em}($\Gamma$ jest wierzchołkiem $z$ stopnia $d(z) \geq 7$)}
          \State{\textbf{return} $\min\{1+\Call{VC}{G \setminus \{z\}, T \cup (N(z), 2), k-1},$\label{ckx_tuple_1}\\
                                       \hspace{8.9em}$ d(z) + \Call{VC}{G \setminus N[z], T, k - d(z)}\}$}
        \Else\Comment{$\Gamma$ jest dobrą parą $(u, z)$ gdzie $\neg(z \dagger v \in N(u))$}
          \State{\textbf{return} $\min\{1+\Call{VC}{G \setminus \{z\}, T, k-1},$\\
                                       \hspace{8.9em}$d(z) + \Call{VC}{G \setminus N[z], T \cup (N(u), 2), k - d(z)}\}$}\label{ckx_tuple_2}
        \EndIf
      \EndFunction
    \end{algorithmic}
  \end{algorithm}

  Wewnątrz głównej funkcji \textsc{VC} zdefiniowane są następujące funkcje pomocnicze.
  \begin{itemize}
    \item Funkcja \textsc{Redukcja}, działająca zgodnie z~pseudokodem~\ref{alg_ckx_reduction}.
    \item Funkcja \textsc{War\_Zwijanie}, działająca zgodnie z~pseudokodem~\ref{alg_ckx_conditional_gf}.
    \item Funkcja \textsc{War\_Strukt}, działająca zgodnie z~pseudokodem~\ref{alg_ckx_conditional_struction}.
  \end{itemize}

  Do zadań funkcji pomocniczej \textsc{Redukcja} należy dekompozycja istniejących krotek do odpowiadających im nowych 2-krotek, redukcja przestrzeni poszukiwań przez wykonywanie operacji strukturyzacji i~uogólnionej operacji zwijania na grafie, a~także utrzymywanie odpowiedniego stanu kolejki $T$ w celu uniknięcia konfliktów pomiędzy ograniczeniami nałożonymi na aktualnie rozpatrywany egzemplarz problemu przez kolejne redukcje dziedziny.

  \begin{algorithm}
   \caption{Algorytm Chena, Kanji oraz Xia --- funkcja \textsc{Redukcja}}\label{alg_ckx_reduction}
   \begin{algorithmic}[1]
    \Function{Redukcja}{}
      \ForAll$(S, q) \in T$
        \If{$|S|<q$}
          \State{odrzuć krotkę $(S, q)$}
        \EndIf
        \ForAll{$u \in S$}
          \State$T \gets T \cup \{(S \setminus \{u\}, q-1)\}$\label{a2}\Comment{Dekompozycja krotki}
        \EndFor
        \If{$S$ nie jest zbiorem niezależnym w $G$}
          \State$T \gets T \cup (\bigcup_{(u, v) \in E; u,v \in S}\{(S \setminus \{u, v\}, q-1)\})$\label{a3}\Comment{Dekomp. krotki}
        \EndIf
        \If{$\exists_{v \in V}: |N(v) \cap S|\geq |S| - q + 1$}\label{a4}
          \State{\textbf{return} $(1 + $VC($G \setminus \{v\}, T, k-1$)$)$}
        \EndIf
      \EndFor
      \If{\textsc{War\_Zwijanie}($G$) \textbf{or} \textsc{War\_Strukt}($G$) są aplikowalne}\label{b}
        \State\Comment{Kolejność operacji ma znaczenie.}
        \State{\textbf{return}}\Comment{Operacje zostają zastosowane w~ramach warunku.}
      \EndIf
      \If{$\exists_{u, v \in V}: v \ddagger u$}
        \State{\textbf{return} $(1 + $\textsc{VC}($G \setminus \{v\}, T, k-1$)}
      \EndIf
    \EndFunction
   \end{algorithmic}
  \end{algorithm}

  Funkcje pomocnicze~\textsc{War\_Zwijanie} oraz \textsc{War\_Strukt} podejmują decyzję o zastosowaniu kolejno uogólnionej operacji zwijania oraz operacji strukturyzacji wobec wartości redukcji parametru $k$ możliwych do uzyskania dla aktualnego egzemplarza problemu oraz aktualnie wybranej krotki.

  \begin{algorithm}
   \caption{Algorytm Chena, Kanji oraz Xia --- funkcja \textsc{War\_Zwijanie}}\label{alg_ckx_conditional_gf}
   \begin{algorithmic}[1]
    \Function{War\_Zwijanie}{}
      \If{Istnieje silna 2-krotka $(\{u, z\}, 1) \in T$}
        \If{powtórzone zastosowanie op. \textsc{Zwijanie} redukuje $k$ do $k^\prime \leq k-2$}
          \State{wykonuj \textsc{Zwijanie} dopóki to możliwe}
        \ElsIf{zastosowanie op. \textsc{Zwijanie} redukuje $k$ o 1 \textbf{and} $d(u) < 4$}
          \State{wykonuj \textsc{Zwijanie} dopóki to możliwe}
        \EndIf
      \Else
        \State{wykonuj \textsc{Zwijanie} dopóki to możliwe}
      \EndIf
    \EndFunction
   \end{algorithmic}
  \end{algorithm}

  \begin{algorithm}
   \caption{Algorytm Chena, Kanji oraz Xia --- funkcja \textsc{War\_Strukt}}\label{alg_ckx_conditional_struction}
   \begin{algorithmic}[1]
    \Function{War\_Strukt}{}
      \If{istnieje silna 2-krotka $\{u, v\} \in T$}
        \If{$\exists_{w \in \{u, v\}}: d(w)=3$ i $w$ poddaje się op. \textsc{Strukturyzacja}}\label{struction_applicable1}
          \State{zastosuj operację \textsc{Strukturyzacja} na wierzchołku $w$}
        \EndIf
      \ElsIf{$\exists_{u \in V}: 3 \leq d(u) \leq 4$ i $u$ poddaje się op. \textsc{Strukturyzacja}}\label{struction_applicable2}
          \State{zastosuj operację \textsc{Strukturyzacja} na wierzchołku $u$}
      \EndIf
    \EndFunction
   \end{algorithmic}
  \end{algorithm}
 }
\par{
  Krotki utworzone przez algorytm podczas rozgałęziania (wiersze~\algref{alg_ckx}{ckx_tuple_1} --- \algref{alg_ckx}{ckx_tuple_2} algorytmu \textsc{VC}) są wykorzystywane w~ramach funkcji \textsc{Redukcja} do tworzenia 2-krotek w~oparciu o~zasady opisywane w~krokach~\algref{alg_ckx_reduction}{a2} i~\algref{alg_ckx_reduction}{a3}.
  Podczas procesu tworzenia 2-krotek, niektóre wierzchołki mogą okazać się odpowiednie do włączenia do optymalnego pokrycia wierzchołkowego, o czym decyduje krok~\algref{alg_ckx_reduction}{a4}.
  Przykładowo, zakładając istnienie krotki $(S=\{u, w, z\}, 1)$, nałożone przez nią ograniczenie mówi, że można poszukiwać optymalnego pokrycia wierzchołkowego wykluczającego co najmniej jeden wierzchołek należący do zbioru $S$.
  W tej sytuacji jeżeli wierzchołek $v$ jest wspólnym sąsiadem wierzchołków $u$, $w$ i $z$, to wierzchołek $v$ może zostać włączony do optymalnego pokrycia wierzchołkowego spełniającego narzuconą własność.
  Wierzchołek $v$ zostanie zatem włączony do pokrycia wierzchołkowego przez krok~\algref{alg_ckx_reduction}{a4}.

  Utrzymywanie odpowiedniego stanu kolejki priorytetowej $T$ sprowadza się do sprawdzenia czy przed rozpoczęciem kroku~\algref{alg_ckx_reduction}{b} istnieją w kolejce $T$ 2-krotki.
  Jeżeli w~kolejce $T$ istnieje silna 2-krotka, to zostanie ona przechowana --- w przeciwnym razie, jeżeli kolejka zawiera jakąkolwiek 2-krotkę, to zostanie ona przechowana.
  Wszystkie pozostałe krotki zostaną usunięte z~kolejki $T$.
  Przechowanie jednej 2-krotki uzasadnione jest tym, że 2-krotki stanowią struktury o~najwyższym priorytecie, a~zatem po zakończeniu działania funckji \textsc{Redukcja} algorytm \textsc{VC} wybierze tę krotkę jako pierwszą do przetworzenia.
  W momencie gdy algorytm \textsc{VC} utworzy nowe krotki w~chwili kolejnego rozgałęzienia, przechowana 2-krotka nie będzie już zawarta w~kolejce $T$ --- a~zatem nie nastąpi konflikt narzuconych przez krotki własności.

  Wiersze~\algref{alg_ckx_conditional_struction}{struction_applicable1} oraz~\algref{alg_ckx_conditional_struction}{struction_applicable2} funkcji \textsc{War\_Strukt} korzystają z pojęcia \emph{aplikowalności} operacji strukturyzacji do pewnego wierzchołka $v$.
  Własność ta sprowadza się do sprawdzenia, czy wśród wierzchołków należących do zbioru $N(v)$ istnieje co najwyżej $p-1$ antykrawędzi, gdzie $p=|N(v)|$ --- zgodnie z~dowodem twierdzenia~\ref{th_struction_feasibility}.
}
\subsubsection{\textbf{Priorytety struktur w~grafie}}
\label{sss_ckx_priorities}
\par{
  Ostatnią z koncepcji wymaganych do zrozumienia sposobu postępowania algorytmu Chena, Kanji oraz Xia jest priorytet struktury, oparty na relacjach pomiędzy składającymi się na nią wierzchołkami.
  Priorytety struktur stanowią klucz do porządku utrzymywanego w~kolejce priorytetowej $T$.
  Im wyższy priorytet danej struktury, tym większą oferuje ona korzyść w redukcji przestrzeni poszukiwań pokrycia wierzchołkowego.
  Priorytet przypisywany jest strukturze w~momencie jej utworzenia.
  Jeżeli dowolna z~opisanych wcześniej operacji wykonywana w~ramach działania algorytmu wpływa na wierzchołki zawarte w~pewnej strukturze $\Gamma=(S, q) \in T$, to jej priorytet musi zostać odpowiednio zmodyfikowany --- może zaistnieć również sytuacja, w której struktura $\Gamma$ zostanie usunięta z~kolejki $T$.
  Sytuacja, w której struktura $\Gamma$ musi zostać usunięta z~kolejki $T$ następuje w~momencie, gdy zachodzi jedna z~następujących własności.
  \begin{enumerate}
    \item Zmniejszono wartość $q$ struktury $\Gamma$ do $0$.
    \item Struktura $\Gamma$ jest jednoelementowym zbiorem wierzchołków i~nastąpiło usunięcie wierzchołka należącego do struktury $\Gamma$ z dziedziny poszukiwań.
    \item Struktura $\Gamma$ stanowi dobrą parę wierzchołków i~jeden z~wierzchołków składowych struktury $\Gamma$ zostanie usunięty z~dziedziny poszukiwań.
  \end{enumerate}
  
  W pozostałych przypadkach struktura $\Gamma$ jest aktualizowana zgodnie z~opisem zawartym w~podrozdziale~\ref{ss_ckx_preliminaries}\footnote{Należy zaznaczyć, że autorzy pracy~\cite{ImprovedBounds10} pozostawiają decyzje związane z~algorytmem aktualizacji struktur w~gestii czytelnika.}.

  Pełne zestawienie struktur mogących znajdować się w kolejce $T$ w dowolnym momencie wykonywania algorytmu $VC$ przedstawione zostanie wedle porządku nierosnącej wartości priorytetu.
  \begin{enumerate}[(1)]
    \item Struktura $\Gamma$ jest silną 2-krotką.
    \item Struktura $\Gamma$ jest 2-krotką.
    \item Struktura $\Gamma$ jest dobrą parą wierzchołków $(u, z)$ o stopniu wierzchołka $u$ wynoszącym $d(u)=3$ oraz gdzie wszystkie wierzchołki sąsiednie $v_u \in N(u)$ są stopnia $d(v_u)=5$ i nie współdzielą żadnych wierzchołków sąsiednich poza wierzchołkiem $u$.
    \item Struktura $\Gamma$ jest dobrą parą wierzchołków $(u, z)$ o stopniach wierzchołków wynoszących $d(u)=3, d(z) \geq 5$.
    \item Struktura $\Gamma$ jest dobrą parą wierzchołków $(u, z)$ o stopniach wierzchołków wynoszących $d(u)=3, d(z) \geq 4$.
    \item Struktura $\Gamma$ jest dobrą parą wierzchołków $(u, z)$ o stopniu wierzchołka $u$ wynoszącym $d(u)=4$ oraz gdzie wierzchołek $u$ ma co najmniej trzy wierzchołki sąsiednie $v_u \in N(u)$ stopnia $d(v_u)=5$ i dodatkowo wśród wierzchołków $v_u$ istnieje co najmniej jedna krawędź.
    \item Struktura $\Gamma$ jest dobrą parą wierzchołków $(u, z)$ o stopniu wierzchołka $u$ wynoszącym $d(u)=3$ oraz gdzie wszystkie wierzchołki sąsiednie $v_u \in N(u)$ są stopnia $d(v_u)=5$ i nie współdzielą żadnych wierzchołków sąsiednich poza wierzchołkiem $u$.
    \item Struktura $\Gamma$ jest jednoelementowym zbiorem $\{z\}$, gdzie stopień wierzchołka $z$ wynosi $d(z) \geq 8$.
    \item Struktura $\Gamma$ jest dobrą parą wierzchołków $(u, z)$ o stopniach wierzchołków wynoszących $d(u)=4, d(z) \geq 5$.
    \item Struktura $\Gamma$ jest dobrą parą wierzchołków $(u, z)$ o stopniach wierzchołków wynoszących $d(u)=5, d(z) \geq 6$.
    \item Struktura $\Gamma$ jest jednoelementowym zbiorem $\{z\}$, gdzie stopień wierzchołka $z$ wynosi $d(z) \geq 7$.
    \item Struktura $\Gamma$ jest dowolną dobrą parą wierzchołków niespełniającą wyżej wymienionych kryteriów.
  \end{enumerate}

  Kluczową obserwacją dotyczącą zestawienia struktur mogących znajdować się w kolejce $T$ jest to, że powyższa lista jest wyczerpująca.
  \begin{theorem}
    Dowolny niepusty graf $G$ musi zawierać jedną ze struktur określonych zestawieniem przedstawionym w~podrozdziale~\ref{sss_ckx_priorities}, co gwarantuje ciągłe istnienie pewnej struktury do wyboru przez algorytm \textsc{VC}.
  \end{theorem}
  \begin{bproof}
    Założyć wpierw należy, że stopień wierzchołków w~grafie $G$ nie jest ograniczony z~góry wartością 2 --- w przeciwnym razie funkcja \textsc{Redukcja} przetworzyłaby graf, zmieniając jego strukturę --- oraz, że graf $G$ jest spójny (dla grafów niespójnych algorytm \textsc{VC} wywoła się rekurencyjnie na każdej ze spójnych składowych).
    Jeżeli graf $G$ ma wierzchołek $v$ stopnia $d(v) \geq 7$, to spełniona musi być przynajmniej jedna z~własności (8), (11).
    W przeciwnym razie graf $G$ ma wierzchołek $v$ stopnia $d(v) \leq 6$.
    Jeżeli graf $G$ jest regularny (w rozumieniu definicji~\ref{def_regular}), to wtedy dla każdej dobrej pary $(u, z)$ jest spełniona własność $d(u)=d(z)$ --- w tej sytuacji jedynie własność (12) znajduje zastosowanie.
    Jeżeli graf $G$ nie jest regularny, to przyjąć należy $u$ jako wierzchołek najmniejszego stopnia w~grafie $G$.
    Ponieważ graf $G$ nie jest regularny oraz maksymalny stopień wierzchołka w~grafie $G$ wynosi $d_{\max} \leq 6$, graf $G$ musi zawierać wierzchołek $u$ stopnia $d(u) \leq 5$.
    Jeżeli stopień wierzchołka $u$ wynosi $d(u)=3$, to musi zachodzić jedna z~własności (3), (4), (5).
    Jeżeli stopień wierzchołka $u$ wynosi $d(u)=4$, to musi zachodzić jedna z~własności (6), (7), (9).
    Jeżeli stopień wierzchołka $u$ wynosi $d(u)=5$, to musi zachodzić własność (10).
  \end{bproof}
}
